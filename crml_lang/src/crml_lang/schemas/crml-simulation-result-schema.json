{
  "$defs": {
    "CurrencyUnit": {
      "properties": {
        "kind": {
          "const": "currency",
          "default": "currency",
          "title": "Kind",
          "type": "string"
        },
        "code": {
          "title": "Code",
          "type": "string"
        },
        "symbol": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Symbol"
        }
      },
      "required": [
        "code"
      ],
      "title": "CurrencyUnit",
      "type": "object"
    },
    "EngineInfo": {
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Version"
        }
      },
      "required": [
        "name"
      ],
      "title": "EngineInfo",
      "type": "object"
    },
    "HistogramArtifact": {
      "properties": {
        "kind": {
          "const": "histogram",
          "default": "histogram",
          "title": "Kind",
          "type": "string"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "unit": {
          "anyOf": [
            {
              "$ref": "#/$defs/CurrencyUnit"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "bin_edges": {
          "items": {
            "type": "number"
          },
          "title": "Bin Edges",
          "type": "array"
        },
        "counts": {
          "items": {
            "type": "integer"
          },
          "title": "Counts",
          "type": "array"
        },
        "binning": {
          "additionalProperties": true,
          "title": "Binning",
          "type": "object"
        }
      },
      "required": [
        "id"
      ],
      "title": "HistogramArtifact",
      "type": "object"
    },
    "InputInfo": {
      "properties": {
        "model_name": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Model Name"
        },
        "model_version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Model Version"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        }
      },
      "title": "InputInfo",
      "type": "object"
    },
    "Measure": {
      "properties": {
        "id": {
          "title": "Id",
          "type": "string"
        },
        "value": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Value"
        },
        "unit": {
          "anyOf": [
            {
              "$ref": "#/$defs/CurrencyUnit"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "parameters": {
          "additionalProperties": true,
          "title": "Parameters",
          "type": "object"
        },
        "label": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Label"
        }
      },
      "required": [
        "id"
      ],
      "title": "Measure",
      "type": "object"
    },
    "ResultPayload": {
      "properties": {
        "measures": {
          "items": {
            "$ref": "#/$defs/Measure"
          },
          "title": "Measures",
          "type": "array"
        },
        "artifacts": {
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/HistogramArtifact"
              },
              {
                "$ref": "#/$defs/SamplesArtifact"
              }
            ]
          },
          "title": "Artifacts",
          "type": "array"
        }
      },
      "title": "ResultPayload",
      "type": "object"
    },
    "RunInfo": {
      "properties": {
        "runs": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Runs"
        },
        "seed": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Seed"
        },
        "runtime_ms": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Runtime Ms"
        },
        "started_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Started At"
        }
      },
      "title": "RunInfo",
      "type": "object"
    },
    "SamplesArtifact": {
      "properties": {
        "kind": {
          "const": "samples",
          "default": "samples",
          "title": "Kind",
          "type": "string"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "unit": {
          "anyOf": [
            {
              "$ref": "#/$defs/CurrencyUnit"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "values": {
          "items": {
            "type": "number"
          },
          "title": "Values",
          "type": "array"
        },
        "sample_count_total": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Sample Count Total"
        },
        "sample_count_returned": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Sample Count Returned"
        },
        "sampling": {
          "additionalProperties": true,
          "title": "Sampling",
          "type": "object"
        }
      },
      "required": [
        "id"
      ],
      "title": "SamplesArtifact",
      "type": "object"
    },
    "Units": {
      "properties": {
        "currency": {
          "$ref": "#/$defs/CurrencyUnit"
        },
        "horizon": {
          "anyOf": [
            {
              "enum": [
                "annual",
                "monthly",
                "daily",
                "event",
                "unknown"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "unknown",
          "title": "Horizon"
        }
      },
      "required": [
        "currency"
      ],
      "title": "Units",
      "type": "object"
    }
  },
  "description": "Engine-agnostic, visualization-agnostic simulation result envelope.\n\nThis model lives in `crml_lang` so engines and UIs can share a stable contract.",
  "properties": {
    "schema_id": {
      "const": "crml.simulation.result",
      "default": "crml.simulation.result",
      "title": "Schema Id",
      "type": "string"
    },
    "schema_version": {
      "default": "1.0.0",
      "title": "Schema Version",
      "type": "string"
    },
    "success": {
      "default": false,
      "title": "Success",
      "type": "boolean"
    },
    "errors": {
      "items": {
        "type": "string"
      },
      "title": "Errors",
      "type": "array"
    },
    "warnings": {
      "items": {
        "type": "string"
      },
      "title": "Warnings",
      "type": "array"
    },
    "engine": {
      "$ref": "#/$defs/EngineInfo"
    },
    "run": {
      "$ref": "#/$defs/RunInfo"
    },
    "inputs": {
      "$ref": "#/$defs/InputInfo"
    },
    "units": {
      "anyOf": [
        {
          "$ref": "#/$defs/Units"
        },
        {
          "type": "null"
        }
      ],
      "default": null
    },
    "results": {
      "$ref": "#/$defs/ResultPayload"
    }
  },
  "required": [
    "engine"
  ],
  "title": "SimulationResultEnvelope",
  "type": "object"
}
