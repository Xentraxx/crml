{
  "$defs": {
    "CurrencyUnit": {
      "properties": {
        "kind": {
          "const": "currency",
          "default": "currency",
          "description": "Unit kind discriminator.",
          "title": "Kind",
          "type": "string"
        },
        "code": {
          "description": "ISO 4217 currency code (e.g. 'USD', 'EUR').",
          "title": "Code",
          "type": "string"
        },
        "symbol": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional currency display symbol (e.g. '$', 'â‚¬').",
          "title": "Symbol"
        }
      },
      "required": [
        "code"
      ],
      "title": "CurrencyUnit",
      "type": "object"
    },
    "EngineInfo": {
      "properties": {
        "name": {
          "description": "Engine name/identifier.",
          "title": "Name",
          "type": "string"
        },
        "version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Engine version string.",
          "title": "Version"
        }
      },
      "required": [
        "name"
      ],
      "title": "EngineInfo",
      "type": "object"
    },
    "HistogramArtifact": {
      "properties": {
        "kind": {
          "const": "histogram",
          "default": "histogram",
          "description": "Artifact kind discriminator.",
          "title": "Kind",
          "type": "string"
        },
        "id": {
          "description": "Artifact identifier.",
          "title": "Id",
          "type": "string"
        },
        "unit": {
          "anyOf": [
            {
              "$ref": "#/$defs/CurrencyUnit"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional unit metadata for this artifact."
        },
        "bin_edges": {
          "description": "Histogram bin edge values.",
          "items": {
            "type": "number"
          },
          "title": "Bin Edges",
          "type": "array"
        },
        "counts": {
          "description": "Histogram bin counts (same length as bins minus one).",
          "items": {
            "type": "integer"
          },
          "title": "Counts",
          "type": "array"
        },
        "binning": {
          "additionalProperties": true,
          "description": "Optional binning configuration/metadata (engine-defined).",
          "title": "Binning",
          "type": "object"
        }
      },
      "required": [
        "id"
      ],
      "title": "HistogramArtifact",
      "type": "object"
    },
    "InputInfo": {
      "properties": {
        "model_name": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional input model name (from scenario/portfolio meta).",
          "title": "Model Name"
        },
        "model_version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional input model version (from scenario/portfolio meta).",
          "title": "Model Version"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional input model description (from meta).",
          "title": "Description"
        }
      },
      "title": "InputInfo",
      "type": "object"
    },
    "Measure": {
      "properties": {
        "id": {
          "description": "Measure identifier (e.g. 'eal', 'var_95').",
          "title": "Id",
          "type": "string"
        },
        "value": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Numeric measure value.",
          "title": "Value"
        },
        "unit": {
          "anyOf": [
            {
              "$ref": "#/$defs/CurrencyUnit"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional unit metadata for this measure."
        },
        "parameters": {
          "additionalProperties": true,
          "description": "Optional parameterization metadata for this measure (engine/UI defined).",
          "title": "Parameters",
          "type": "object"
        },
        "label": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional human-friendly label for display.",
          "title": "Label"
        }
      },
      "required": [
        "id"
      ],
      "title": "Measure",
      "type": "object"
    },
    "ResultPayload": {
      "properties": {
        "measures": {
          "description": "List of computed summary measures.",
          "items": {
            "$ref": "#/$defs/Measure"
          },
          "title": "Measures",
          "type": "array"
        },
        "artifacts": {
          "description": "List of computed artifacts (histograms/samples).",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/HistogramArtifact"
              },
              {
                "$ref": "#/$defs/SamplesArtifact"
              }
            ]
          },
          "title": "Artifacts",
          "type": "array"
        }
      },
      "title": "ResultPayload",
      "type": "object"
    },
    "RunInfo": {
      "properties": {
        "runs": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Number of Monte Carlo runs/samples executed.",
          "title": "Runs"
        },
        "seed": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Random seed used by the engine (if any).",
          "title": "Seed"
        },
        "runtime_ms": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Execution time in milliseconds (best-effort).",
          "title": "Runtime Ms"
        },
        "started_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "UTC timestamp when execution started.",
          "title": "Started At"
        }
      },
      "title": "RunInfo",
      "type": "object"
    },
    "SamplesArtifact": {
      "properties": {
        "kind": {
          "const": "samples",
          "default": "samples",
          "description": "Artifact kind discriminator.",
          "title": "Kind",
          "type": "string"
        },
        "id": {
          "description": "Artifact identifier.",
          "title": "Id",
          "type": "string"
        },
        "unit": {
          "anyOf": [
            {
              "$ref": "#/$defs/CurrencyUnit"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional unit metadata for this artifact."
        },
        "values": {
          "description": "Sample values (may be truncated for size).",
          "items": {
            "type": "number"
          },
          "title": "Values",
          "type": "array"
        },
        "sample_count_total": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Total sample count produced by the engine.",
          "title": "Sample Count Total"
        },
        "sample_count_returned": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Number of samples included in 'values'.",
          "title": "Sample Count Returned"
        },
        "sampling": {
          "additionalProperties": true,
          "description": "Optional sampling configuration/metadata (engine-defined).",
          "title": "Sampling",
          "type": "object"
        }
      },
      "required": [
        "id"
      ],
      "title": "SamplesArtifact",
      "type": "object"
    },
    "SimulationResult": {
      "description": "Simulation result payload for `SimulationResultEnvelope`.",
      "properties": {
        "success": {
          "default": false,
          "description": "True if the run completed successfully.",
          "title": "Success",
          "type": "boolean"
        },
        "errors": {
          "description": "List of error messages (if any).",
          "items": {
            "type": "string"
          },
          "title": "Errors",
          "type": "array"
        },
        "warnings": {
          "description": "List of warning messages (if any).",
          "items": {
            "type": "string"
          },
          "title": "Warnings",
          "type": "array"
        },
        "engine": {
          "$ref": "#/$defs/EngineInfo",
          "description": "Engine identification and version metadata."
        },
        "run": {
          "$ref": "#/$defs/RunInfo",
          "description": "Execution/run metadata."
        },
        "inputs": {
          "$ref": "#/$defs/InputInfo",
          "description": "Input model metadata captured for reporting."
        },
        "units": {
          "anyOf": [
            {
              "$ref": "#/$defs/Units"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional unit metadata for values in this result."
        },
        "results": {
          "$ref": "#/$defs/ResultPayload",
          "description": "The result payload (measures/artifacts)."
        }
      },
      "required": [
        "engine"
      ],
      "title": "SimulationResult",
      "type": "object"
    },
    "Units": {
      "properties": {
        "currency": {
          "$ref": "#/$defs/CurrencyUnit",
          "description": "Currency unit used for monetary measures/artifacts."
        },
        "horizon": {
          "anyOf": [
            {
              "enum": [
                "annual",
                "monthly",
                "daily",
                "event",
                "unknown"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "unknown",
          "description": "Time horizon/period unit for rates/annualized figures when applicable.",
          "title": "Horizon"
        }
      },
      "required": [
        "currency"
      ],
      "title": "Units",
      "type": "object"
    }
  },
  "description": "Engine-agnostic, visualization-agnostic simulation result envelope.\n\nThis model lives in `crml_lang` so engines and UIs can share a stable contract.",
  "properties": {
    "crml_simulation_result": {
      "const": "1.0",
      "default": "1.0",
      "description": "Simulation result document version identifier.",
      "title": "Crml Simulation Result",
      "type": "string"
    },
    "result": {
      "$ref": "#/$defs/SimulationResult",
      "description": "The simulation result payload."
    }
  },
  "required": [
    "result"
  ],
  "title": "SimulationResultEnvelope",
  "type": "object"
}
