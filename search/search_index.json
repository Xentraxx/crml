{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"Auto-Calibration/","title":"Auto-calibration","text":"<p>\u201cAuto-calibration\u201d refers to fitting parameters from empirical evidence rather than manually choosing them.</p> <p>In this repo, the reference engine supports a limited but practical form:</p> <ul> <li>lognormal calibration from <code>single_losses</code></li> </ul> <p>See: Calibrate from Data</p>"},{"location":"Contributing/","title":"Contributing to CRML","text":"<p>Thank you for your interest in contributing to CRML! We welcome contributions from everyone.</p>"},{"location":"Contributing/#development-setup","title":"\ud83d\udee0\ufe0f Development Setup","text":""},{"location":"Contributing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.9+</li> <li>git</li> <li>pip</li> </ul>"},{"location":"Contributing/#1-fork-and-clone","title":"1. Fork and Clone","text":"<p>Fork the repository on GitHub, then clone your fork:</p> <pre><code>git clone https://github.com/YOUR_USERNAME/crml.git\ncd crml\n</code></pre>"},{"location":"Contributing/#2-create-a-virtual-environment","title":"2. Create a Virtual Environment","text":"<pre><code>python3 -m venv venv\nsource venv/bin/activate  # On Windows: venv\\Scripts\\activate\n</code></pre>"},{"location":"Contributing/#3-install-dependencies","title":"3. Install Dependencies","text":"<p>Install the packages in editable mode with dev dependencies:</p> <pre><code>pip install -e ./crml_lang -e ./crml_engine\n</code></pre>"},{"location":"Contributing/#running-tests","title":"\ud83e\uddea Running Tests","text":"<p>We use <code>pytest</code> for testing. Ensure you have activated your virtual environment.</p>"},{"location":"Contributing/#run-all-tests","title":"Run All Tests","text":"<pre><code>pytest\n</code></pre>"},{"location":"Contributing/#run-specific-tests","title":"Run Specific Tests","text":"<pre><code>pytest tests/test_controls.py\n</code></pre>"},{"location":"Contributing/#check-coverage","title":"Check Coverage","text":"<pre><code>pytest --cov=crml_lang --cov=crml_engine\n</code></pre>"},{"location":"Contributing/#code-style","title":"\ud83d\udcbb Code Style","text":"<p>We follow PEP 8 guidelines. Please ensure your code is formatted correctly.</p> <ul> <li>Indent: 4 spaces</li> <li>Line Length: 88 characters (Black default)</li> <li>Docstrings: Google style docstrings</li> </ul>"},{"location":"Contributing/#running-linters","title":"Running Linters","text":"<pre><code># Install linting tools if not already present\npip install black flake8 isort\n\n# Format code\nblack .\nisort .\n\n# Check for issues\nflake8 .\n</code></pre>"},{"location":"Contributing/#pull-request-process","title":"\ud83d\udcdd Pull Request Process","text":"<ol> <li> <p>Create a Branch: <pre><code>git checkout -b feature/my-new-feature\n</code></pre></p> </li> <li> <p>Make Changes:</p> </li> <li>Write clear, concise code.</li> <li>Add docstrings to new functions/classes.</li> <li> <p>Update <code>README.md</code> or documentation if needed.</p> </li> <li> <p>Add Tests:</p> </li> <li>If adding a feature, add a test case in <code>tests/</code>.</li> <li> <p>Ensure all tests pass with <code>pytest</code>.</p> </li> <li> <p>Commit:</p> </li> <li>Use clear commit messages (Conventional Commits preferred).</li> <li> <p>Example: <code>feat: add attack chain validation</code></p> </li> <li> <p>Push and PR: <pre><code>git push origin feature/my-new-feature\n</code></pre></p> </li> <li>Go to GitHub and open a Pull Request against <code>main</code>.</li> <li>Describe your changes and link any related issues.</li> </ol>"},{"location":"Contributing/#documentation","title":"\ud83d\udcc4 Documentation","text":"<ul> <li>Wiki: If you are adding a major feature, please consider updating the Wiki.</li> <li>Specification: Changes to the language itself require updating <code>wiki/Reference/CRML-1.1.md</code>.</li> </ul>"},{"location":"Contributing/#reporting-issues","title":"\ud83d\udc1b Reporting Issues","text":"<p>If you find a bug or have a feature request, please open an issue on GitHub: https://github.com/Faux16/crml/issues</p> <p>Please include: - CRML version - Python version - Operating system - Steps to reproduce - Example YAML model (if applicable)</p>"},{"location":"Contributing/#license","title":"\u2696\ufe0f License","text":"<p>By contributing, you agree that your contributions will be licensed under the MIT License.</p>"},{"location":"Control-Effectiveness/","title":"Control effectiveness","text":"<p>Control effectiveness is represented in CRML as a combination of:</p> <ul> <li>Implementation effectiveness (how well the control works when it is up)</li> <li>Coverage (what fraction of relevant scope it covers)</li> <li>Reliability (probability the control is \u201cup\u201d in a given run)</li> <li>Affects surface (<code>frequency</code>, <code>severity</code>, or <code>both</code>)</li> </ul> <p>Scenarios reference controls by id; portfolios provide the implementation/measurement values.</p>"},{"location":"Control-Effectiveness/#reference-engine-behavior","title":"Reference engine behavior","text":"<p>The reference engine applies controls as multiplicative reductions (per run):</p> <ul> <li>reduction = <code>effectiveness \u00d7 coverage \u00d7 state</code></li> <li>multiplier = <code>1 - reduction</code></li> </ul> <p>See:</p> <ul> <li>Engine capabilities: Controls</li> <li>Engine capabilities: Portfolio execution</li> </ul>"},{"location":"Control-Effectiveness/#language-contracts","title":"Language contracts","text":"<p>The portable document fields are defined in the schemas:</p> <ul> <li>Scenario schema</li> <li>Portfolio schema</li> </ul>"},{"location":"Examples/","title":"Examples","text":"<p>Browse example patterns organized by practical risk-management approaches.</p> <ul> <li>By Industry</li> <li>Full Examples</li> <li>FAIR Baseline Model</li> <li>QBER Enterprise Model</li> <li>Best Practices</li> <li>Specification Examples</li> </ul>"},{"location":"Getting-Started/","title":"Getting Started","text":"<p>This guide expands on the Quickstart and shows a typical workflow across scenario and portfolio documents.</p>"},{"location":"Getting-Started/#1-install-the-engine-cli","title":"1) Install the engine (CLI)","text":"<pre><code>pip install crml-engine\n</code></pre>"},{"location":"Getting-Started/#2-validate-a-scenario","title":"2) Validate a scenario","text":"<p>Pick an example scenario from the repo:</p> <pre><code>crml validate examples/scenarios/scenario-phishing.yaml\n</code></pre>"},{"location":"Getting-Started/#3-simulate-a-scenario","title":"3) Simulate a scenario","text":"<pre><code>crml simulate examples/scenarios/scenario-phishing.yaml --runs 20000\n</code></pre> <p>For JSON output:</p> <pre><code>crml simulate examples/scenarios/scenario-phishing.yaml --runs 20000 --format json &gt; result.json\n</code></pre>"},{"location":"Getting-Started/#4-run-a-portfolio-exposure-multiple-scenarios","title":"4) Run a portfolio (exposure + multiple scenarios)","text":"<p>Portfolios bind scenarios to assets and scale per-asset frequency basis.</p> <pre><code>crml validate examples/portfolios/portfolio.yaml\ncrml simulate examples/portfolios/portfolio.yaml --runs 20000\n</code></pre> <p>Read the portable rules for exposure scaling here:</p> <ul> <li>CRML Specification (Overview)</li> </ul>"},{"location":"Getting-Started/#5-use-multi-currency-fx-config","title":"5) Use multi-currency (FX config)","text":"<p>The reference engine supports an FX config document for output currency conversion.</p> <p>See: Multi-Currency Support</p>"},{"location":"Home/","title":"CRML Documentation","text":"<p>CRML (Cyber Risk Modeling Language) is a declarative YAML/JSON format for describing cyber risk models.</p> <p>This repository is split into two Python packages:</p> <ul> <li><code>crml_lang</code> (language/spec): models + schema + validation + YAML IO</li> <li><code>crml_engine</code> (reference engine): CLI + simulation/runtime (depends on <code>crml_lang</code>)</li> </ul>"},{"location":"Home/#quick-links","title":"Quick links","text":"<ul> <li>Language overview: Language/Overview</li> <li>Engine overview: Engine/Overview</li> <li>Quickstart (CLI): Quickstart</li> <li>Examples: Examples</li> <li>Scenario schema + docs: Language/Overview</li> </ul>"},{"location":"Home/#install","title":"Install","text":"<p>If you want the CLI (<code>crml validate</code>, <code>crml simulate</code>):</p> <pre><code>pip install crml-engine\n</code></pre> <p>If you only want the language library in Python:</p> <pre><code>pip install crml-lang\n</code></pre>"},{"location":"Home/#minimal-example","title":"Minimal example","text":"<pre><code>crml_scenario: \"1.0\"\n\nmeta:\n  name: \"ransomware-risk\"\n\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters:\n      lambda: 0.15\n\n  severity:\n    model: lognormal\n    parameters:\n      median: \"500 000\"\n      currency: USD\n      sigma: 1.5\n</code></pre>"},{"location":"Home/#contributing","title":"Contributing","text":"<p>See Contributing.</p>"},{"location":"Installation/","title":"Installation Guide","text":"<p>CRML is split into two Python packages:</p> <ul> <li><code>crml-lang</code> (language/spec): models + schema + validation + YAML IO</li> <li><code>crml-engine</code> (engine): simulation runtime + <code>crml</code> CLI</li> </ul>"},{"location":"Installation/#quick-install","title":"Quick install","text":"<p>If you want the CLI:</p> <pre><code>pip install crml-engine\n</code></pre> <p>If you only want the language library:</p> <pre><code>pip install crml-lang\n</code></pre> <p>Verify the CLI install with:</p> <pre><code>crml --help\n</code></pre>"},{"location":"Installation/#platform-specific-instructions","title":"Platform-Specific Instructions","text":""},{"location":"Installation/#macos","title":"macOS","text":"<p>Option 1: Using pip (Recommended) <pre><code># Install Python 3.9+ if needed\nbrew install python3\n\n# Install CRML engine + CLI\npip3 install crml-engine\n\n# Verify\ncrml --help\n</code></pre></p> <p>Option 2: Using pipx (Isolated) <pre><code># Install pipx\nbrew install pipx\npipx ensurepath\n\n# Install CRML engine + CLI\npipx install crml-engine\n\n# Verify\ncrml --help\n</code></pre></p>"},{"location":"Installation/#linux-ubuntudebian","title":"Linux (Ubuntu/Debian)","text":"<pre><code># Update package list\nsudo apt update\n\n# Install Python 3.9+\nsudo apt install python3 python3-pip\n\n# Install CRML engine + CLI\npip3 install crml-engine\n\n# Add to PATH if needed\necho 'export PATH=\"$HOME/.local/bin:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\n\n# Verify\ncrml --help\n</code></pre>"},{"location":"Installation/#windows","title":"Windows","text":"<p>Option 1: Using pip <pre><code># Install Python 3.9+ from python.org\n\n# Install CRML engine + CLI\npip install crml-engine\n\n# Verify\ncrml --help\n</code></pre></p> <p>Option 2: Using Windows Terminal <pre><code># Install Python from Microsoft Store\n# Then:\npip install crml-engine\n</code></pre></p>"},{"location":"Installation/#crml-studio-setup","title":"CRML Studio Setup","text":""},{"location":"Installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Node.js 18+ and npm</li> <li>Git</li> </ul>"},{"location":"Installation/#installation","title":"Installation","text":"<pre><code># Clone repository\ngit clone https://github.com/Faux16/crml.git\ncd crml/web\n\n# Install dependencies\nnpm install\n\n# Run development server\nnpm run dev\n</code></pre> <p>Visit http://localhost:3000</p>"},{"location":"Installation/#troubleshooting","title":"Troubleshooting","text":"<p>See Troubleshooting Guide for common issues.</p>"},{"location":"Multi-Currency-Support/","title":"Multi-Currency Support","text":"<p>CRML supports explicit currencies on monetary severity inputs and optional FX configuration for deterministic conversions and reporting.</p> <p>This page documents the behavior of the reference engine (<code>crml_engine</code>) as implemented today.</p> <ul> <li>Overview and examples: Quickstart</li> <li>Full reference: CRML Specification</li> <li>CLI usage: Quickstart</li> </ul>"},{"location":"Multi-Currency-Support/#what-you-can-express-in-crml","title":"What you can express in CRML","text":"<p>Currency can be attached to severity inputs via <code>scenario.severity.parameters.currency</code>.</p> <p>Example (lognormal median in EUR):</p> <pre><code>crml_scenario: \"1.0\"\nmeta:\n    name: \"example\"\nscenario:\n    frequency:\n        basis: per_organization_per_year\n        model: poisson\n        parameters:\n            lambda: 1\n    severity:\n        model: lognormal\n        parameters:\n            median: 100000\n            currency: EUR\n            sigma: 1.2\n</code></pre>"},{"location":"Multi-Currency-Support/#how-the-reference-engine-handles-currencies","title":"How the reference engine handles currencies","text":"<p>At runtime, the engine uses an FX configuration (<code>fx_config</code>) with two roles:</p> <ul> <li>Normalization: severity inputs are converted into <code>fx_config.base_currency</code> before sampling.</li> <li>Reporting: after simulation, results are reported in <code>fx_config.output_currency</code>.</li> </ul> <p>If you do not provide an FX config, the engine uses a default config (USD base/output + built-in default rates).</p>"},{"location":"Multi-Currency-Support/#what-gets-converted","title":"What gets converted","text":"<p>The reference engine currently converts the following severity parameters:</p> <ul> <li>Lognormal<ul> <li><code>median</code> is converted from <code>parameters.currency</code> into <code>base_currency</code>.</li> <li><code>mu</code> is adjusted by <code>ln(rate)</code> when a non-base currency is specified.</li> <li><code>single_losses</code> are converted into <code>base_currency</code> before calibration.</li> </ul> </li> <li>Gamma<ul> <li><code>scale</code> is converted from <code>parameters.currency</code> into <code>base_currency</code>.</li> </ul> </li> </ul>"},{"location":"Multi-Currency-Support/#reporting-currency","title":"Reporting currency","text":"<p>After the simulation, if <code>base_currency != output_currency</code>, the engine converts the sampled annual losses from base to output. The output currency appears in:</p> <ul> <li><code>SimulationResult.metadata.currency_code</code> / <code>SimulationResult.metadata.currency</code></li> <li>The engine-agnostic result document: <code>CRSimulationResult.result.units.currency</code></li> </ul>"},{"location":"Multi-Currency-Support/#notes-current-limitations","title":"Notes / current limitations","text":"<ul> <li>The engine\u2019s default rates are authored with USD as the base.     If you set <code>base_currency</code> to something else, you must also provide a <code>rates</code> table that is consistent with that base.</li> <li>The current severity mixture implementation is simplified and uses only the first component.</li> </ul>"},{"location":"Multi-Currency-Support/#fx-config-document","title":"FX config document","text":"<p>FX config is a separate YAML document type (not a CRML scenario/portfolio). It is identified by a top-level discriminator:</p> <pre><code>crml_fx_config: \"1.0\"\nbase_currency: USD\noutput_currency: EUR\nas_of: \"2025-01-15\"  # optional\nrates:\n    USD: 1.0\n    EUR: 1.08\n    GBP: 1.26\n</code></pre> <p>Rate semantics used by the reference engine:</p> <ul> <li><code>rates[CCY]</code> is the value of 1 unit of <code>CCY</code> in <code>base_currency</code>.     For example, with <code>base_currency: USD</code>, <code>rates.EUR: 1.08</code> means 1 EUR = 1.08 USD.</li> <li> <p>Conversion is performed as:</p> <pre><code>amount_to = amount_from * rate_from / rate_to\n</code></pre> </li> </ul> <p>Examples you can start from:</p> <ul> <li>examples/fx_configs/fx-config.yaml</li> <li>examples/fx_configs/fx-config-eur.yaml</li> </ul>"},{"location":"Multi-Currency-Support/#using-fx-config","title":"Using FX config","text":""},{"location":"Multi-Currency-Support/#cli","title":"CLI","text":"<p>Use <code>--fx-config</code> with <code>simulate</code>:</p> <pre><code>crml simulate examples/scenarios/multi-currency-example.yaml --fx-config examples/fx_configs/fx-config-eur.yaml\n</code></pre>"},{"location":"Multi-Currency-Support/#python-api","title":"Python API","text":"<p>You can pass FX config either as a dict or as an <code>FXConfig</code> instance:</p> <pre><code>from crml_engine.runtime import run_simulation\n\nfx_config = {\n        \"base_currency\": \"USD\",\n        \"output_currency\": \"EUR\",\n        \"rates\": {\"USD\": 1.0, \"EUR\": 1.08},\n}\n\nresult = run_simulation(yaml_content, n_runs=10000, seed=42, fx_config=fx_config)\n</code></pre>"},{"location":"Python-API/","title":"Python API","text":"<p>CRML is split into two Python packages:</p> <ul> <li><code>crml_lang</code>: load/validate/transform CRML documents</li> <li><code>crml_engine</code>: execute CRML documents (simulation runtime + CLI)</li> </ul> <p>Use these pages:</p> <ul> <li>Language Python API (crml_lang)</li> <li>Engine Python API (crml_engine)</li> </ul>"},{"location":"Quickstart/","title":"Quick Start Guide (5 Minutes)","text":"<p>Get up and running with CRML in just 5 minutes!</p>"},{"location":"Quickstart/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.9 or higher</li> <li>pip package manager</li> </ul>"},{"location":"Quickstart/#step-1-install-crml-30-seconds","title":"Step 1: Install CRML (30 seconds)","text":"<p>Install the engine package to get the <code>crml</code> CLI:</p> <pre><code>pip install crml-engine\n</code></pre> <p>Verify installation: <pre><code>crml --help\n</code></pre></p>"},{"location":"Quickstart/#step-2-create-your-first-model-2-minutes","title":"Step 2: Create Your First Model (2 minutes)","text":"<p>Create a file called <code>my-first-scenario.yaml</code>:</p> <pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"my-first-risk-model\"\n  description: \"A simple phishing risk model\"\n\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters:\n      lambda: 0.10  # 10% chance per organization per year\n\n  severity:\n    model: lognormal\n    parameters:\n      median: \"22 000\"  # $22K median loss\n      currency: USD\n      sigma: 1.0        # Moderate variability\n</code></pre> <p>What this models: - A single organization with a 10% annual chance of an incident - Each incident costs ~$22K on average</p> <p>If you want multi-asset / per-asset modeling (e.g. 100 employees, 500 endpoints), put assets in a portfolio document and reference one or more scenarios.</p>"},{"location":"Quickstart/#step-3-validate-your-model-30-seconds","title":"Step 3: Validate Your Model (30 seconds)","text":"<pre><code>crml validate my-first-scenario.yaml\n</code></pre> <p>You should see: <pre><code>\u2713 CRML model is valid\n</code></pre></p>"},{"location":"Quickstart/#step-4-run-simulation-1-minute","title":"Step 4: Run Simulation (1 minute)","text":"<pre><code>crml simulate my-first-scenario.yaml --runs 10000\n</code></pre> <p>You'll see results like: <pre><code>\ud83d\udcca Simulation Results\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nExpected Annual Loss (EAL): $220,000\nVaR 95%: $450,000\nVaR 99%: $650,000\n\nSimulation completed in 1.2s\n</code></pre></p>"},{"location":"Quickstart/#step-5-try-crml-studio-1-minute","title":"Step 5: Try CRML Studio (1 minute)","text":"<p>Want a visual interface? Try CRML Studio:</p> <pre><code># Clone the repo (if you haven't)\ngit clone https://github.com/Faux16/crml.git\ncd crml/web\n\n# Install and run\nnpm install\nnpm run dev\n</code></pre> <p>Visit http://localhost:3000/simulation</p>"},{"location":"Quickstart/#what-you-just-did","title":"What You Just Did","text":"<p>\u2705 Installed CRML \u2705 Created a risk model \u2705 Validated it \u2705 Ran a Monte Carlo simulation \u2705 Got risk metrics (EAL, VaR)</p>"},{"location":"Quickstart/#next-steps","title":"Next Steps","text":""},{"location":"Quickstart/#learn-more","title":"Learn More","text":"<ul> <li>CRML Specification - Current language contracts + semantics</li> <li>Best Practices - Practical modeling guidance and limitations</li> <li>Examples - Pre-built models</li> </ul>"},{"location":"Quickstart/#try-different-scenarios","title":"Try Different Scenarios","text":"<ul> <li>Modify <code>lambda</code> to see how baseline threat frequency (threat likelihood) affects risk</li> <li>Change <code>median</code> to model different threat impacts (loss per event)</li> <li>Increase <code>cardinality</code> for larger organizations</li> </ul>"},{"location":"Quickstart/#advanced-features","title":"Advanced Features","text":"<ul> <li>Export results: <code>crml simulate model.yaml --format json &gt; results.json</code></li> <li>Use in Python (language API): <code>from crml_lang import CRScenario</code></li> <li>Use in Python (engine runtime): <code>from crml_engine.runtime import run_simulation</code></li> <li>Build complex models with mixture distributions</li> </ul>"},{"location":"Quickstart/#common-issues","title":"Common Issues","text":"<p>\"Command not found: crml\" - Make sure Python's bin directory is in your PATH - Try: <code>python -m crml_engine.cli --help</code></p> <p>\"Invalid YAML\" - Check indentation (use spaces, not tabs) - Run <code>crml validate</code> to see specific errors</p> <p>\"Simulation takes too long\" - Reduce <code>--runs</code> to 1000 for faster results - Default 10,000 runs is recommended for accuracy</p>"},{"location":"Quickstart/#get-help","title":"Get Help","text":"<ul> <li>\ud83d\udcd6 Full Documentation</li> <li>\ud83e\uddea Interactive Simulation</li> <li>\ud83d\udcac GitHub Issues</li> <li>\ud83d\udce7 Email Support</li> </ul> <p>Ready to build real risk models? Start with Best Practices and then consult the CRML Specification.</p>"},{"location":"Concepts/Architecture-Engine/","title":"CRML Engine Architecture (crml_engine)","text":"<p><code>crml_engine</code> implements the CRML reference runtime:</p> <ul> <li><code>crml</code> CLI (validation + simulation)</li> <li>scenario Monte Carlo execution</li> <li>portfolio execution (planning + multi-scenario aggregation)</li> <li>result models and an engine-agnostic result envelope</li> </ul> <p>It depends on <code>crml_lang</code> for parsing, schemas, and validation.</p> <p>Deterministic planning lives in <code>crml_engine.pipeline</code>.</p> <p>Bundling (inlining referenced documents into <code>CRPortfolioBundle</code>) lives in <code>crml_lang</code>.</p>"},{"location":"Concepts/Architecture-Engine/#package-layout","title":"Package layout","text":"<ul> <li><code>crml_engine/src/crml_engine/cli.py</code>: <code>crml</code> command (thin wrapper)</li> <li><code>crml_engine/src/crml_engine/runtime.py</code>: high-level runtime entrypoints</li> <li><code>crml_engine/src/crml_engine/simulation/</code>: Monte Carlo core</li> <li><code>engine.py</code>: orchestration (<code>run_monte_carlo</code>)</li> <li><code>frequency.py</code>: frequency engines</li> <li><code>severity.py</code>: severity engines</li> <li><code>crml_engine/src/crml_engine/models/</code>: result models + FX model</li> <li><code>crml_engine/src/crml_engine/copula.py</code>: Gaussian copula utility used for correlated control states</li> </ul>"},{"location":"Concepts/Architecture-Engine/#cli-architecture","title":"CLI architecture","text":"<p>The CLI is intentionally thin and delegates work to the language validator and the runtime.</p> <pre><code>flowchart TD\n    ARGV[User argv] --&gt; CLI[crml_engine.cli:main]\n\n    CLI --&gt;|validate| V[crml_lang.validate / validators\\nValidationReport.render_text]\n\n    CLI --&gt;|simulate| RT[crml_engine.runtime.run_simulation_cli]\n    RT --&gt; RUN[run_simulation / run_portfolio_simulation]\n</code></pre>"},{"location":"Concepts/Architecture-Engine/#runtime-entrypoints","title":"Runtime entrypoints","text":""},{"location":"Concepts/Architecture-Engine/#scenario-execution","title":"Scenario execution","text":"<p>Scenario execution uses a single scenario document and runs Monte Carlo.</p> <pre><code>flowchart TD\n    IN[\"Scenario YAML/JSON or file path\"] --&gt; MC[\"run_monte_carlo (orchestrator)\"]\n    MC --&gt;|first| PARSE[\"Parse + Pydantic validate&lt;br/&gt;CRScenario model\"]\n    PARSE --&gt; FREQ[\"FrequencyEngine.generate_frequency\"]\n    FREQ --&gt; SEV[\"SeverityEngine.generate_severity\"]\n    SEV --&gt; AGG[\"Aggregate annual losses\"]\n    AGG --&gt; MET[\"Metrics + histogram\"]\n    MET --&gt; RES[\"SimulationResult\"]\n</code></pre> <p>Notes:</p> <ul> <li>Parsing and Pydantic validation happen at the start of <code>run_monte_carlo</code> (before any simulation work).</li> <li>Full CRML schema + semantic validation is provided by <code>crml validate</code> / <code>crml_lang.validate</code>.</li> <li>Scenario documents are scenario-only; exposure scaling is supplied via the runtime as <code>cardinality</code>.</li> <li>Currency conversion is applied through the FX config.</li> </ul>"},{"location":"Concepts/Architecture-Engine/#portfolio-execution","title":"Portfolio execution","text":"<p>Portfolio execution consumes a portfolio document (or an inlined bundle), resolves it into a plan (via <code>crml_engine.pipeline</code>), runs each referenced scenario, and aggregates under portfolio semantics.</p> <pre><code>flowchart TD\n    PIN[\"Portfolio YAML/JSON or file path\"] --&gt; PLAN[\"crml_engine.pipeline.plan_portfolio\"]\n    B[\"CRPortfolioBundle\"] --&gt; PLAN2[\"crml_engine.pipeline.plan_bundle\"]\n    PLAN --&gt;|ok| EXEC[\"run_portfolio_simulation\"]\n    PLAN2 --&gt;|ok| EXEC\n    EXEC --&gt; CST[\"Sample control states&lt;br/&gt;(independent or copula-correlated)\"]\n    CST --&gt; LOOP[\"For each scenario in plan\"]\n    LOOP --&gt; SCIN[\"Read scenario YAML\"]\n    SCIN --&gt; MULT[\"Compute per-run multipliers&lt;br/&gt;frequency_rate_multiplier / severity_loss_multiplier\"]\n    MULT --&gt; MC[\"run_monte_carlo&lt;br/&gt;(cardinality + multipliers)\"]\n    MC --&gt; SLOSS[\"Per-run annual losses\"]\n    SLOSS --&gt; AGG[\"Aggregate across scenarios&lt;br/&gt;(sum / max / mixture / choose_one)\"]\n    AGG --&gt; OUT[\"SimulationResult\"]\n</code></pre>"},{"location":"Concepts/Architecture-Engine/#scf-cmm-maturity-handling","title":"SCF CMM maturity handling","text":"<p>When a control is assessed using SCF Capability Maturity Model (CMM) levels (<code>scf_cmm_level: 0..5</code>), the reference engine:</p> <ul> <li>Treats maturity as an ordinal scale (not a percentage).</li> <li>Does not assume risk (or control effectiveness) improves linearly with the maturity level.</li> <li>Applies a non-linear mapping from CMM level to an effectiveness factor in [0, 1], then uses that effectiveness in the runtime multipliers.</li> </ul> <p>Important:</p> <ul> <li>Any engine that supports <code>scf_cmm_level</code> MUST implement a sensible non-linear mapping; it is part of the engine\u2019s specification/behavior.</li> <li>The specific mapping is engine-defined; the reference engine\u2019s mapping is implemented in <code>crml_engine.pipeline.portfolio_planner._scf_cmm_level_to_effectiveness</code>.</li> </ul>"},{"location":"Concepts/Architecture-Engine/#result-formats","title":"Result formats","text":"<p>The engine supports two result layers:</p> <ul> <li><code>SimulationResult</code>: runtime-friendly result model used by CLI text output.</li> <li><code>CRSimulationResult</code>: engine-agnostic contract designed for tools/UIs.</li> </ul> <p><code>run_simulation_envelope(...)</code> converts the runtime result into a stable envelope format.</p>"},{"location":"Concepts/Architecture-Engine/#web-integration-crml-studio","title":"Web integration (CRML Studio)","text":"<p>The web UI in <code>web/</code> integrates by calling:</p> <ul> <li>validation: executes <code>crml validate</code> and parses its output</li> <li>simulation: runs Python and calls <code>crml_engine.runtime.run_simulation_envelope</code></li> </ul> <p>This ensures the UI uses the same validator/runtime behavior as the CLI.</p>"},{"location":"Concepts/Architecture-Language/","title":"CRML Language Architecture (crml_lang)","text":"<p><code>crml_lang</code> implements the CRML language/spec layer:</p> <ul> <li>document models (Pydantic)</li> <li>bundled JSON Schemas</li> <li>structured validation (schema + semantic checks)</li> <li>YAML load/dump helpers</li> </ul> <p>It also defines engine-agnostic contract models that engines/pipelines can produce (e.g. <code>CRPortfolioBundle</code>).</p> <p>It intentionally does not run simulations.</p>"},{"location":"Concepts/Architecture-Language/#package-layout","title":"Package layout","text":"<ul> <li><code>crml_lang/src/crml_lang/api.py</code>: public, stable convenience API (recommended imports)</li> <li><code>crml_lang/src/crml_lang/models/</code>: typed document models</li> <li><code>crml_lang/src/crml_lang/schemas/</code>: JSON Schemas shipped as package data</li> <li><code>crml_lang/src/crml_lang/validators/</code>: document-type validators returning <code>ValidationReport</code></li> </ul>"},{"location":"Concepts/Architecture-Language/#inputs-and-outputs","title":"Inputs and outputs","text":""},{"location":"Concepts/Architecture-Language/#inputs","title":"Inputs","text":"<ul> <li>Scenario document (<code>crml_scenario: \"1.0\"</code>)</li> <li>Portfolio document (<code>crml_portfolio: \"1.0\"</code>)</li> <li>Control catalog document (<code>crml_control_catalog: \"1.0\"</code>)</li> <li>Attack catalog document (<code>crml_attack_catalog: \"1.0\"</code>)</li> <li>Assessment document (<code>crml_assessment: \"1.0\"</code>)</li> <li>Control relationships pack (<code>crml_control_relationships: \"1.0\"</code>)</li> </ul>"},{"location":"Concepts/Architecture-Language/#outputs","title":"Outputs","text":"<ul> <li><code>ValidationReport</code>: structured validation (errors + warnings) with optional text rendering</li> <li><code>CRSimulationResult</code>: standardized, engine-agnostic output contract for risk engines and visualization tools</li> </ul>"},{"location":"Concepts/Architecture-Language/#bundle-contract","title":"Bundle contract","text":"<p><code>crml_lang</code> defines <code>CRPortfolioBundle</code> as an engine-agnostic, self-contained artifact that inlines a portfolio's referenced scenarios (and optionally control catalogs, assessments, and control relationships packs).</p> <p>This bundle is inlined-only: it does not contain planning-derived fields (e.g., per-scenario cardinality or resolved control effects).</p> <p>Producing bundles is a language/tooling concern implemented in <code>crml_lang</code>.</p> <p>Building an execution plan from a bundle is a deterministic engine pipeline concern implemented in <code>crml_engine.pipeline</code>.</p>"},{"location":"Concepts/Architecture-Language/#validation-architecture","title":"Validation architecture","text":"<p>Validation is schema-first and structured.</p> <pre><code>flowchart TD\n    DOC[CRML YAML/JSON document] --&gt; LOAD[Load YAML/JSON as mapping]\n    LOAD --&gt; SCHEMA[\"JSON Schema validation&lt;br/&gt;(generated from Pydantic models)\"]\n    SCHEMA --&gt;|ok| SEM[\"Semantic checks&lt;br/&gt;best-practice warnings/errors\"]\n    SCHEMA --&gt;|errors| RPT[\"ValidationReport&lt;br/&gt;ok=false\"]\n    SEM --&gt; RPT2[\"ValidationReport&lt;br/&gt;ok=true/false\"]\n</code></pre> <p>Notes:</p> <ul> <li>Validators are split by document type under <code>crml_lang.validators</code>.</li> <li>The CLI uses <code>ValidationReport.render_text(...)</code> to display results, but tools can consume the structured messages directly.</li> </ul>"},{"location":"Concepts/Architecture-Language/#public-api","title":"Public API","text":"<p>Recommended entrypoints:</p> <ul> <li><code>from crml_lang import validate</code> (scenario validation)</li> <li><code>from crml_lang import validate_portfolio</code> (portfolio validation)</li> <li><code>from crml_lang import bundle_portfolio</code> (create a self-contained <code>CRPortfolioBundle</code>)</li> <li><code>from crml_lang import CRScenario, CRPortfolio, CRPortfolioBundle</code> (typed document/contract models)</li> </ul>"},{"location":"Concepts/Architecture/","title":"CRML System Architecture","text":"<p>CRML is organized into three layers:</p> <ul> <li>Language/spec (<code>crml_lang</code>): schemas, models, validation, YAML IO</li> <li>Runtime/engine (<code>crml_engine</code>): CLI + simulation runtime + portfolio execution + result serialization</li> <li>Web UI (<code>web/</code>): CRML Studio (Next.js UI + API routes that call the CLI/runtime)</li> </ul> <p>In addition to these layers, most real deployments also use calibration tooling:</p> <ul> <li>Calibration tools (separate tool responsibility but might be part of an engine): ingest organization-specific evidence (e.g., incident logs) and write back calibrated CRML scenarios/portfolios.</li> </ul> <p>For the detailed architecture, see:</p> <ul> <li>Architecture-Language</li> <li>Architecture-Engine</li> </ul>"},{"location":"Concepts/Architecture/#document-types","title":"Document types","text":"<ul> <li>Scenario documents: <code>crml_scenario: \"1.0\"</code> (top-level <code>scenario:</code>)</li> <li>Portfolio documents: <code>crml_portfolio: \"1.0\"</code> (top-level <code>portfolio:</code>; if <code>portfolio.assessments</code> is used, <code>portfolio.control_catalogs</code> must also be provided)</li> <li>Control catalog documents: <code>crml_control_catalog: \"1.0\"</code> (top-level <code>catalog:</code>)</li> <li>Attack catalog documents: <code>crml_attack_catalog: \"1.0\"</code> (top-level <code>catalog:</code>)</li> <li>Attack\u2192control relationships documents: <code>crml_attack_control_relationships: \"1.0\"</code> (top-level <code>relationships:</code>; attack-pattern to control mappings)</li> <li>Assessment documents: <code>crml_assessment: \"1.0\"</code> (top-level <code>assessment:</code>)</li> <li>Control relationships documents: <code>crml_control_relationships: \"1.0\"</code> (top-level <code>relationships:</code>; control-to-control mappings with overlap metadata)</li> <li>FX config documents: <code>crml_fx_config: \"1.0\"</code> (top-level <code>base_currency</code>, <code>output_currency</code>, <code>rates</code>, optional <code>as_of</code>; engine-owned config document)</li> <li>Portfolio bundle artifacts: <code>crml_portfolio_bundle: \"1.0\"</code> (top-level <code>portfolio_bundle:</code>)</li> <li>Simulation result artifacts: <code>crml_simulation_result: \"1.0\"</code> (top-level <code>result:</code>)</li> </ul> <p>See also:</p> <ul> <li>Reference/CRML-Schema (where schemas live and how they\u2019re generated)</li> <li>Language/Schemas/Scenario and Language/Schemas/Portfolio</li> </ul>"},{"location":"Concepts/Architecture/#responsibility-boundaries-why-this-split-exists","title":"Responsibility boundaries (why this split exists)","text":"<p>CRML intentionally splits responsibilities so tools can interoperate cleanly:</p> <ul> <li><code>crml_lang</code> owns document shape (schemas), validation, and the interchange contracts used between tools/engines.</li> <li><code>crml_engine</code> (and other engines) own execution semantics for engine-defined <code>model</code> strings and runtime configuration.</li> </ul> <p>Attack-graph semantics and attack\u2192attack mappings are explicitly an engine/tool responsibility:</p> <ul> <li>CRML mandates the ability to incorporate a baseline attack catalog (typically MITRE ATT&amp;CK) via <code>crml_attack_catalog</code>.</li> <li>If an engine supports additional attack frameworks (e.g., CAPEC) or needs attack\u2192attack crosswalks, that mapping logic/data is outside the CRML language contract.</li> </ul> <p>Two important contracts are language-owned:</p> <ul> <li>Portfolio bundle (<code>crml_portfolio_bundle: \"1.0\"</code>): an inlined, filesystem-free input artifact.</li> <li>Simulation result envelope (<code>crml_simulation_result: \"1.0\"</code>): a stable output container for downstream tools/UIs.</li> </ul>"},{"location":"Concepts/Architecture/#system-level-data-flow","title":"System-level data flow","text":"<pre><code>flowchart TD\n    DOC[\"CRML YAML/JSON\"]\n    ORGDATA[\"Org evidence&lt;br/&gt;(incident logs, telemetry)\"]\n\n    subgraph L[\"crml_lang (language/spec responsibility)&lt;br/&gt;Ends after validation + bundling\"]\n        LANG[\"crml_lang&lt;br/&gt;validate\"]\n        BUNDLE[\"crml_lang&lt;br/&gt;bundle\"]\n    end\n\n    subgraph T[\"Tooling (engine/tool responsibility)&lt;br/&gt;Optional calibration step\"]\n        CAL[\"calibrate&lt;br/&gt;(fit/update scenario params)\"]\n    end\n\n    subgraph E[\"crml_engine (engine responsibility)&lt;br/&gt;Planning + execution\"]\n        PIPE[\"crml_engine.pipeline&lt;br/&gt;plan\"]\n        ENG[\"crml_engine&lt;br/&gt;execute\"]\n    end\n\n    subgraph W[\"web/ (UI responsibility)\"]\n        WEB[CRML Studio UI]\n    end\n\n    DOC --&gt; LANG\n    LANG --&gt;|ValidationReport| TOOL[CLI/CI/Web tooling]\n\n    ORGDATA -.-&gt; CAL\n    DOC -.-&gt; CAL\n    CAL -.-&gt;|updated CRML YAML/JSON| DOC\n\n    DOC --&gt; BUNDLE\n    BUNDLE --&gt;|CRPortfolioBundle| PIPE\n    PIPE --&gt;|PortfolioExecutionPlan| ENG\n    ENG --&gt; RES[CRSimulationResult]\n    RES --&gt; WEB\n</code></pre>"},{"location":"Concepts/Architecture/#ecosystem-data-flow","title":"Ecosystem data flow","text":"<p>CRML is designed so that organizations can assemble auditable, portable input artifacts from common upstream sources, and so that any compliant engine can emit results in a shared format that downstream tools can visualize.</p> <p>In practice:</p> <ul> <li>Threat intelligence produces or informs scenario documents (frequency, severity, narratives, assumptions).</li> <li>Attack catalogs provide stable attack-pattern identifiers and metadata (titles/urls/tags) that scenarios and tools can reference.</li> <li>Organization evidence (incident logs, internal loss data, telemetry) can be used by calibration tools to fit scenario parameters and reduce reliance on purely external priors.</li> <li>Portfolios describe the organization's relatively stable assets, business units, and exposure structure. They can be updated via internal tooling (e.g., CMDB/asset inventory imports), but the portfolio document remains the central reference.</li> <li>Control catalogs come from recognized authorities and frameworks (e.g., NIS, CIS) or can be commonly defined by the community. These catalogs define the canonical control set and their semantics.</li> <li>Assessments come from assessment/scan tools and audits. They capture which controls exist, how effective they are, and can optionally be used to populate or update the portfolio's control mapping.</li> <li>Mappings (control-to-control relationships) can come from public sources (e.g., Secure Controls Framework) and from community or organization-specific mapping work.</li> </ul> <p>An additional (common) integration artifact is attack-to-control mapping:</p> <ul> <li>Tools/community datasets can map attack-pattern ids (from an attack catalog) to control ids (from a control catalog).</li> <li>CRML standardizes this as a first-class document type via <code>crml_attack_control_relationships</code>, so engines/tools can share mapping documents.</li> </ul> <p>The language layer then provides a deterministic bundling step that inlines the referenced material into a self-contained <code>CRPortfolioBundle</code>, which can be handed to any risk engine without requiring filesystem access.</p> <p>Engines are expected to return results using the language-owned result document (<code>CRSimulationResult</code>). This creates a stable interface for any visualization tool (web UI, BI dashboards, reporting pipelines) to consume outputs without being coupled to a specific engine implementation.</p> <pre><code>flowchart LR\n    TI[\"Threat intelligence&lt;br/&gt;feeds\"] --&gt;|publish| AC[\"Attack catalog&lt;br/&gt;CRAttackCatalog\"]\n    TI --&gt;|publish/inform| S[\"Scenario documents&lt;br/&gt;CRScenario\"]\n    AC -.-&gt;|reference ids/metadata| S\n\n    EVID[\"Organization evidence&lt;br/&gt;(incident logs, telemetry)\"] --&gt;|calibrate| CAL\n\n    subgraph T2[\"Calibration tooling&lt;br/&gt;(engine/tool responsibility)\"]\n        CAL[\"calibrate&lt;br/&gt;(fit/update scenarios)\"]\n    end\n\n    CAL --&gt;|write back| S\n\n    ORG[\"Organization asset inventory&lt;br/&gt;(relatively static)\"] --&gt;|generate| P[\"Portfolio document&lt;br/&gt;CRPortfolio\"]\n    TOOL[\"Tooling (e.g. SIEM)&lt;br/&gt;imports and updates assets\"] -.-&gt;|optional| P\n\n    AUTH[\"Recognized authorities&lt;br/&gt;NIS, CIS\"] --&gt;|publish| CC[\"Control catalog&lt;br/&gt;CRControlCatalog\"]\n    SCAN[\"Assessment and scan tools\"] --&gt;|generate| CA[\"Assessment catalog&lt;br/&gt;CRAssessment\"]\n\n    COMM[\"Community / org mappings\"] --&gt;|publish| CR[\"Control relationships pack&lt;br/&gt;CRControlRelationships\"]\n\n    MAP[\"Attack\u2192control relationships&lt;br/&gt;CRAttackControlRelationships\"]\n    AC -.-&gt;|attack ids| MAP\n    CC -.-&gt;|control ids| MAP\n    MAP -.-&gt;|suggest relevant controls| S\n\n    CC -.-&gt;|basis| CA\n    CC -.-&gt;|ids| CR\n\n    subgraph L2[\"crml_lang (language/spec responsibility)&lt;br/&gt;Ends after bundling\"]\n        B[\"Bundle step&lt;br/&gt;bundle_portfolio\"]\n        PB[\"CRPortfolioBundle&lt;br/&gt;inlined artifact\"]\n    end\n\n    S --&gt; B\n    P --&gt; B\n    CC --&gt; B\n    CA --&gt; B\n    CR --&gt; B\n    MAP --&gt; B\n    B --&gt; PB\n\n    subgraph E2[\"Engines + tools (outside language responsibility)\"]\n        ENG[\"Risk engines&lt;br/&gt;engine A, engine B\"]\n        OUT[\"CRSimulationResult&lt;br/&gt;standard contract\"]\n        VIZ[\"Visualization tools&lt;br/&gt;dashboards and reports\"]\n    end\n\n    PB --&gt; ENG\n    ENG --&gt; OUT\n    OUT --&gt; VIZ\n</code></pre>"},{"location":"Concepts/Attack-Graphs/","title":"Attack Graphs","text":"<p>Attack graphs model multi-step attacker progression through a system.</p> <p>CRML is not an attack-graph language. Instead, CRML is designed as a portable layer for:</p> <ul> <li>describing scenario frequency/severity assumptions,</li> <li>referencing attack catalogs (e.g. ATT&amp;CK), and</li> <li>connecting those scenarios to portfolios and controls.</li> </ul>"},{"location":"Concepts/Attack-Graphs/#how-attack-graphs-relate-to-crml","title":"How attack graphs relate to CRML","text":"<p>Typical integration patterns:</p> <ul> <li>Use an attack-graph tool to generate scenario candidates or calibrate scenario frequencies.</li> <li>Reference attack-pattern ids and metadata via <code>crml_attack_catalog</code> and <code>crml_attack_control_relationships</code>.</li> <li>Use CRML portfolios and controls to evaluate \u201cwhat if we implement control X?\u201d across multiple scenarios.</li> </ul> <p>See:</p> <ul> <li>Language schemas</li> <li>CRML System Architecture</li> </ul>"},{"location":"Concepts/Deep-Math/","title":"Deep Mathematics","text":"<p>This page collects deeper mathematical background for CRML-style risk simulation.</p> <p>CRML is designed so the language stays stable while engines can evolve their algorithms.</p>"},{"location":"Concepts/Deep-Math/#the-core-simulation-loop","title":"The core simulation loop","text":"<p>A common annual-loss simulation structure is:</p> <ol> <li>Sample event count N from a frequency model.</li> <li>Sample severities X_1, \\dots, X_N from a severity model.</li> <li>Aggregate annual loss L = \\sum_{i=1}^{N} X_i.</li> </ol> <p>Engines may add layers such as control multipliers, dependence structures, or hierarchical modeling.</p>"},{"location":"Concepts/Deep-Math/#heavy-tails-and-percentiles","title":"Heavy tails and percentiles","text":"<p>Risk reporting often focuses on:</p> <ul> <li>Expected annual loss (EAL): \\mathbb{E}[L]</li> <li>Value at Risk: \\text{VaR}_{p}(L), e.g. p=0.95, 0.99</li> </ul> <p>Percentiles are sensitive to tail behavior and require sufficient simulation runs for stability.</p>"},{"location":"Concepts/Deep-Math/#dependence","title":"Dependence","text":"<p>Dependence structures (e.g., copulas) can materially change tail risk.</p> <p>See: Runtime (Copula)</p>"},{"location":"Concepts/Deep-Math/#reference-engine-status","title":"Reference engine status","text":"<p>For what the reference engine supports today (models, controls, portfolios), see:</p> <ul> <li>Engine capabilities: Supported models</li> </ul>"},{"location":"Concepts/FAIR-vs-QBER/","title":"FAIR vs QBER","text":"<p>This page compares two common styles of cyber risk modeling and how they map to CRML.</p> <ul> <li>FAIR-style models often focus on decomposing loss event frequency and loss magnitude using expert-driven factor models.</li> <li>QBER-style models often emphasize a more explicit threat-action view and may include richer control-state and dependency structures.</li> </ul> <p>CRML is flexible: both styles can be represented as scenario documents plus optional portfolio context.</p>"},{"location":"Concepts/FAIR-vs-QBER/#mapping-into-crml","title":"Mapping into CRML","text":"<p>In CRML terms:</p> <ul> <li>Frequency assumptions live in <code>crml_scenario.scenario.frequency</code>.</li> <li>Severity assumptions live in <code>crml_scenario.scenario.severity</code>.</li> <li>Exposure scaling is handled by portfolios via <code>scenario.frequency.basis</code> + portfolio asset binding.</li> <li>Controls can be referenced by scenarios and implemented/measured in portfolios.</li> </ul> <p>See:</p> <ul> <li>CRML Specification (Overview)</li> <li>Best Practices</li> </ul>"},{"location":"Concepts/FAIR-vs-QBER/#reference-engine-status","title":"Reference engine status","text":"<p>Some features (e.g., correlated control-state sampling via copula) are supported by the reference engine and documented under:</p> <ul> <li>Engine capabilities: Controls</li> </ul>"},{"location":"Concepts/Runtime-Copula/","title":"Runtime (Copula)","text":"<p>Copulas are a way to model dependence between random variables while keeping marginal distributions unchanged.</p> <p>In Monte Carlo simulation, a common pattern is:</p> <ol> <li>Sample correlated uniforms (U_1, \\dots, U_d).</li> <li>Transform each uniform into a marginal sample using the inverse CDF of the marginal distribution.</li> </ol>"},{"location":"Concepts/Runtime-Copula/#gaussian-copula-concept","title":"Gaussian copula (concept)","text":"<p>A Gaussian copula uses a multivariate normal correlation structure:</p> <ol> <li>Sample Z \\sim \\mathcal{N}(0, \\Sigma)</li> <li>Convert to uniforms: U_i = \\Phi(Z_i)</li> </ol> <p>where \\Phi is the standard normal CDF.</p>"},{"location":"Concepts/Runtime-Copula/#what-crml-uses-copulas-for","title":"What CRML uses copulas for","text":"<p>The CRML language does not mandate a universal \u201ccopula field\u201d for all dependency modeling. Dependency constructs are generally engine/tool-specific.</p> <p>In this repo, the reference engine supports correlating control-state sampling (binary up/down states) via a Gaussian copula specified in <code>portfolio.dependency.copula</code>.</p> <p>See:</p> <ul> <li>Engine capabilities: Portfolio execution</li> <li>Engine capabilities: Controls</li> </ul>"},{"location":"Concepts/Runtime-Entropy/","title":"Runtime (Entropy)","text":"<p>This page is a conceptual reference for entropy-style measures.</p> <p>Entropy can be used to summarize uncertainty, dispersion, or heterogeneity.</p>"},{"location":"Concepts/Runtime-Entropy/#shannon-entropy-concept","title":"Shannon entropy (concept)","text":"<p>For a discrete distribution with probabilities p_i:</p>  H = -\\sum_i p_i \\log p_i  <p>For continuous variables, differential entropy exists but is not directly comparable across unit changes.</p>"},{"location":"Concepts/Runtime-Entropy/#reference-engine-status","title":"Reference engine status","text":"<p>The reference engine in this repo does not currently compute entropy-based risk metrics as first-class outputs.</p> <p>What it does have today:</p> <ul> <li>A planning-time warning when a bound asset set appears heterogeneous (tags and/or <code>criticality_index.type</code> differ). This is used as a guardrail, not as an entropy measure.</li> </ul> <p>If you want entropy-based measures in results, they should be treated as an engine-defined extension.</p>"},{"location":"Concepts/Runtime-Frequency/","title":"Runtime (Frequency)","text":"<p>This page explains common frequency models used in CRML scenarios.</p> <p>CRML frequency is expressed as a rate model plus a basis:</p> <ul> <li><code>scenario.frequency.model</code>: a model identifier (engine-defined support)</li> <li><code>scenario.frequency.basis</code>: portable semantic meaning of the rate unit</li> </ul> <p>See: CRML Specification (Overview)</p>"},{"location":"Concepts/Runtime-Frequency/#basis-semantics-portable","title":"Basis semantics (portable)","text":"<p>Two basis values are standardized by the language:</p> <ul> <li><code>per_organization_per_year</code>: the scenario\u2019s frequency already represents the total org-wide annual rate.</li> <li><code>per_asset_unit_per_year</code>: the scenario\u2019s frequency represents a per-unit annual rate and MUST be scaled by bound exposure E.</li> </ul> <p>For the normative definition of E (how portfolios bind scenarios to assets), see Exposure scaling and frequency basis.</p>"},{"location":"Concepts/Runtime-Frequency/#common-models","title":"Common models","text":""},{"location":"Concepts/Runtime-Frequency/#poisson","title":"Poisson","text":"<p>A Poisson process is often used for independent event counts.</p> <p>If the annual rate is \\lambda, then the event count N in a year is:</p>  N \\sim \\text{Poisson}(\\lambda)  <p>For <code>per_asset_unit_per_year</code>, the effective annual rate becomes:</p>  \\lambda_{\\text{total}} = \\lambda \\cdot E"},{"location":"Concepts/Runtime-Frequency/#gammapoisson-negative-binomial","title":"Gamma\u2013Poisson (negative binomial)","text":"<p>A common way to model over-dispersion is to treat the Poisson rate as random:</p>  \\lambda \\sim \\text{Gamma}(k, \\theta), \\quad N \\mid \\lambda \\sim \\text{Poisson}(\\lambda)  <p>The resulting marginal distribution for N is negative binomial-like (engine parameterization may vary).</p>"},{"location":"Concepts/Runtime-Frequency/#hierarchical-gammapoisson","title":"Hierarchical Gamma\u2013Poisson","text":"<p>A hierarchical extension can model uncertainty in rate parameters across similar organizations or units. Details are engine-defined.</p>"},{"location":"Concepts/Runtime-Frequency/#reference-engine-status","title":"Reference engine status","text":"<p>Implemented frequency models in the reference engine are listed here:</p> <ul> <li>Engine capabilities: Supported models</li> </ul>"},{"location":"Concepts/Runtime-MCMC/","title":"Runtime (MCMC)","text":"<p>Markov chain Monte Carlo (MCMC) is a family of algorithms for sampling from posterior distributions.</p> <p>In risk modeling, MCMC is typically used for calibration (inferring uncertain model parameters from data) rather than for the forward Monte Carlo simulation of losses.</p>"},{"location":"Concepts/Runtime-MCMC/#conceptual-outline","title":"Conceptual outline","text":"<p>Given parameters \\theta and observed data D, Bayesian inference defines:</p>  P(\\theta \\mid D) \\propto P(D \\mid \\theta)\\,P(\\theta)  <p>MCMC constructs a Markov chain whose stationary distribution is P(\\theta \\mid D).</p>"},{"location":"Concepts/Runtime-MCMC/#reference-engine-status","title":"Reference engine status","text":"<p>The reference engine in this repo does not implement a general MCMC calibration pipeline today.</p> <p>If you need calibration, start with:</p> <ul> <li>Empirical lognormal calibration from <code>single_losses</code> (supported): see Runtime (Severity)</li> </ul> <p>More advanced calibration workflows would be engine/tool-specific.</p>"},{"location":"Concepts/Runtime-Severity/","title":"Runtime (Severity)","text":"<p>This page explains common severity models used in CRML scenarios.</p> <p>CRML severity is expressed as:</p> <ul> <li><code>scenario.severity.model</code>: a model identifier (engine-defined support)</li> <li><code>scenario.severity.parameters</code>: model parameters (portable intent; engine may impose constraints)</li> </ul> <p>See: Scenario schema</p>"},{"location":"Concepts/Runtime-Severity/#lognormal","title":"Lognormal","text":"<p>A lognormal model is common for heavy-tailed loss severities.</p> <p>If X is the loss per event, then:</p>  \\ln X \\sim \\mathcal{N}(\\mu, \\sigma^2)  <p>CRML commonly uses a median-first parameterization for readability:</p> <ul> <li><code>median</code>: the median loss (\\text{median}(X))</li> <li><code>sigma</code>: log-space standard deviation</li> </ul> <p>Relationship between median and \\mu:</p>  \\text{median}(X) = e^{\\mu} \\quad \\Rightarrow \\quad \\mu = \\ln(\\text{median}(X))"},{"location":"Concepts/Runtime-Severity/#empirical-calibration-single_losses","title":"Empirical calibration (<code>single_losses</code>)","text":"<p>Some engines may support calibrating (\\mu, \\sigma) from empirical single-event losses.</p> <p>Reference engine status:</p> <ul> <li>Calibration helper exists: <code>crml_engine.runtime.calibrate_lognormal_from_single_losses</code>.</li> <li>You can also provide <code>single_losses</code> directly in lognormal parameters (engine-defined behavior).</li> </ul>"},{"location":"Concepts/Runtime-Severity/#gamma","title":"Gamma","text":"<p>A gamma distribution is another positive-valued severity model.</p> <p>Common parameterization uses <code>shape</code> (k) and <code>scale</code> (\\theta):</p>  X \\sim \\text{Gamma}(k, \\theta)"},{"location":"Concepts/Runtime-Severity/#mixtures","title":"Mixtures","text":"<p>A mixture model represents severity as a weighted combination of component distributions.</p> <p>Conceptually, you choose a component C with probability w_c and then sample X \\mid C.</p> <p>Important: mixture support is engine-defined.</p> <p>Reference engine limitation:</p> <ul> <li>The current reference engine\u2019s <code>mixture</code> severity uses only the first component and ignores weights.</li> </ul> <p>See: Engine capabilities: Supported models</p>"},{"location":"Engine/CLI/","title":"CLI (<code>crml_engine</code>)","text":"<p>The reference CLI is provided by the <code>crml-engine</code> package.</p> <p>Install:</p> <pre><code>pip install crml-engine\n</code></pre> <p>Help:</p> <pre><code>crml --help\n</code></pre>"},{"location":"Engine/CLI/#commands","title":"Commands","text":""},{"location":"Engine/CLI/#crml-validate-file","title":"<code>crml validate &lt;file&gt;</code>","text":"<p>Validates a CRML document (schema + semantic checks) via <code>crml_lang</code>.</p> <pre><code>crml validate examples/scenarios/phishing.yaml\n</code></pre>"},{"location":"Engine/CLI/#crml-simulate-file","title":"<code>crml simulate &lt;file&gt;</code>","text":"<p>Runs a Monte Carlo simulation using the reference engine.</p> <p>Supported inputs:</p> <ul> <li><code>crml_scenario: \"1.0\"</code></li> <li><code>crml_portfolio: \"1.0\"</code></li> <li><code>crml_portfolio_bundle: \"1.0\"</code></li> </ul> <p>Examples:</p> <pre><code># Scenario\ncrml simulate examples/scenarios/phishing.yaml --runs 10000\n\n# Portfolio\ncrml simulate examples/portfolios/portfolio.yaml --runs 10000\n\n# JSON output\ncrml simulate examples/scenarios/phishing.yaml --runs 20000 --format json &gt; result.json\n</code></pre> <p>Options:</p> <ul> <li><code>-n, --runs</code>: number of runs (default: 10000)</li> <li><code>-f, --format</code>: <code>text</code> or <code>json</code></li> <li><code>--fx-config</code>: path to an FX config YAML document</li> </ul> <p>Important:</p> <ul> <li><code>--seed</code> is currently accepted by the CLI but is not wired through to the simulation wrapper yet. Do not rely on it for reproducibility.</li> </ul>"},{"location":"Engine/CLI/#crml-explain-file","title":"<code>crml explain &lt;file&gt;</code>","text":"<p>Renders a human-readable explanation of a CRML document.</p> <pre><code>crml explain examples/scenarios/phishing.yaml\n</code></pre>"},{"location":"Engine/CLI/#exit-codes","title":"Exit codes","text":"<ul> <li><code>0</code>: success</li> <li><code>1</code>: validation failure, simulation failure, or parse error</li> </ul>"},{"location":"Engine/Installation/","title":"Engine installation (<code>crml_engine</code>)","text":"<p>To run simulations, install the engine package:</p> <pre><code>pip install crml-engine\n</code></pre> <p>This installs the <code>crml</code> CLI.</p> <p>Verify:</p> <pre><code>crml --help\n</code></pre> <p>Notes:</p> <ul> <li>The engine depends on <code>crml_lang</code> for document validation and schema models.</li> <li>If you are developing from source in this monorepo, prefer installing the sub-packages (<code>crml_lang/</code> and <code>crml_engine/</code>) rather than the repo root package.</li> </ul>"},{"location":"Engine/Overview/","title":"Engine overview (<code>crml_engine</code>)","text":"<p><code>crml_engine</code> is the reference execution engine for CRML.</p> <p>It is responsible for:</p> <ul> <li>Executing CRML documents via Monte Carlo simulation.</li> <li>Deciding which models/algorithms are supported (engine-defined).</li> <li>Producing results (including JSON output) for tooling and integrations.</li> </ul> <p>It is not responsible for defining portable document shapes and basic semantics \u2014 that is the job of <code>crml_lang</code>.</p> <p>See also:</p> <ul> <li>Language responsibilities: CRML Specification (Overview)</li> <li>CLI reference: CLI</li> <li>Engine APIs: Python API</li> <li>Implemented features (tests-backed): Capabilities</li> </ul>"},{"location":"Engine/Python-API/","title":"Engine Python API (<code>crml_engine</code>)","text":"<p>The engine package contains runtime entry points for executing CRML documents.</p>"},{"location":"Engine/Python-API/#primary-entry-points","title":"Primary entry points","text":""},{"location":"Engine/Python-API/#run-a-scenario","title":"Run a scenario","text":"<pre><code>from crml_engine.runtime import run_simulation\n\nyaml_text = \"\"\"\ncrml_scenario: \"1.0\"\nmeta:\n  name: \"example\"\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters: {lambda: 0.1}\n  severity:\n    model: lognormal\n    parameters: {median: 22000, currency: USD, sigma: 1.0}\n\"\"\"\n\nresult = run_simulation(yaml_text, n_runs=10000, seed=42)\nassert result.success\nprint(result.metrics.eal)\n</code></pre>"},{"location":"Engine/Python-API/#run-a-portfolio","title":"Run a portfolio","text":"<pre><code>from crml_engine.runtime import run_portfolio_simulation\n\nres = run_portfolio_simulation(\"examples/portfolios/portfolio.yaml\", source_kind=\"path\", n_runs=10000, seed=42)\nassert res.success\n</code></pre>"},{"location":"Engine/Python-API/#run-a-portfolio-bundle","title":"Run a portfolio bundle","text":"<pre><code>from crml_engine.runtime import run_portfolio_bundle_simulation\n\nres = run_portfolio_bundle_simulation(\"examples/portfolio_bundles/portfolio-bundle-documented.yaml\", source_kind=\"path\", n_runs=10000, seed=42)\nassert res.success\n</code></pre>"},{"location":"Engine/Python-API/#results","title":"Results","text":"<p>The runtime returns a <code>SimulationResult</code> (engine-native) and can also produce an engine-agnostic <code>CRSimulationResult</code>.</p> <p>See: Engine capabilities: Results</p>"},{"location":"Engine/Python-API/#engine-defined-behavior","title":"Engine-defined behavior","text":"<p>Model support and execution details are engine-defined.</p> <p>See: Capabilities</p>"},{"location":"Engine/Capabilities/Controls/","title":"Engine capabilities: Controls","text":"<p>Controls are defined in CRML scenarios (what the scenario assumes exists) and implemented/measured in portfolios (what the organization has).</p> <p>This page documents what the reference engine does with control data during portfolio execution.</p>"},{"location":"Engine/Capabilities/Controls/#where-controls-appear","title":"Where controls appear","text":"<ul> <li>Scenario controls: <code>scenario.controls</code> (list of control ids referenced by the scenario)</li> <li>Portfolio controls: <code>portfolio.controls</code> (implementation effectiveness, coverage, reliability, affects)</li> <li>Optional assessments + catalogs: <code>portfolio.assessments</code>, <code>portfolio.control_catalogs</code></li> </ul> <p>Schema docs:</p> <ul> <li>Scenario: Language/Schemas/Scenario</li> <li>Portfolio: Language/Schemas/Portfolio</li> <li>Assessment: Language/Schemas/Assessment</li> <li>Control catalog: Language/Schemas/Control-Catalog</li> </ul>"},{"location":"Engine/Capabilities/Controls/#control-resolution-planning","title":"Control resolution (planning)","text":"<p>Before simulation, the engine creates a portfolio execution plan that resolves each scenario control to an \u201ceffective\u201d control payload.</p> <p>Key behaviors implemented in the portfolio planner:</p> <ul> <li>Portfolio <code>controls</code> take precedence.</li> <li>If assessments are provided, the planner can derive effectiveness from SCF CMM levels using a non-linear mapping.</li> <li>The planner emits errors if:</li> <li>a referenced control id isn\u2019t present in the referenced catalogs (when catalogs are provided)</li> <li>copula targets reference unknown control ids</li> </ul> <p>Implementation: crml_engine/src/crml_engine/pipeline/portfolio_planner.py Implementation: <code>crml_engine/src/crml_engine/pipeline/portfolio_planner.py</code></p>"},{"location":"Engine/Capabilities/Controls/#how-controls-affect-simulation","title":"How controls affect simulation","text":"<p>During simulation, each resolved control contributes a multiplicative reduction:</p> <ul> <li>reduction = <code>implementation_effectiveness \u00d7 coverage \u00d7 state</code></li> <li>multiplier = <code>1 - reduction</code></li> </ul> <p><code>state</code> is per-run and is <code>1</code> when the control is \u201cup\u201d for that run.</p> <p>Controls can affect:</p> <ul> <li><code>frequency</code></li> <li><code>severity</code></li> <li><code>both</code></li> </ul> <p>Implementation: <code>_control_multipliers_for_scenario</code> in crml_engine/src/crml_engine/runtime.py Implementation: <code>_control_multipliers_for_scenario</code> in <code>crml_engine/src/crml_engine/runtime.py</code></p>"},{"location":"Engine/Capabilities/Controls/#reliability-and-correlated-control-state","title":"Reliability and correlated control state","text":"<p>If <code>reliability</code> is provided, the engine samples a per-run Bernoulli state for each control.</p> <p>If the portfolio dependency includes a Gaussian copula over <code>control:&lt;id&gt;:state</code> targets, the engine correlates those Bernoulli samples via copula uniforms.</p> <p>See: Portfolio execution</p>"},{"location":"Engine/Capabilities/Portfolio-Execution/","title":"Engine capabilities: Portfolio execution","text":"<p>This page documents reference-engine behavior when executing portfolios.</p>"},{"location":"Engine/Capabilities/Portfolio-Execution/#execution-flow-reference-engine","title":"Execution flow (reference engine)","text":"<ol> <li>Load + validate the portfolio and referenced artifacts (<code>crml_lang</code>).</li> <li>Plan an execution plan (bind scenarios to assets, resolve controls).</li> <li>Simulate each planned scenario for <code>n_runs</code>.</li> <li>Aggregate scenario losses into a portfolio loss sample using <code>portfolio.semantics.method</code>.</li> </ol> <p>Implementation pointers:</p> <ul> <li>Planning: <code>crml_engine/src/crml_engine/pipeline/portfolio_planner.py</code></li> <li>Runtime execution: <code>crml_engine/src/crml_engine/runtime.py</code></li> </ul>"},{"location":"Engine/Capabilities/Portfolio-Execution/#exposure-scaling","title":"Exposure scaling","text":"<p>Portfolio scenario bindings determine an exposure cardinality E which the engine uses when the scenario\u2019s frequency basis is <code>per_asset_unit_per_year</code>.</p> <p>The portable definition of E and basis semantics is in CRML Specification (Overview).</p>"},{"location":"Engine/Capabilities/Portfolio-Execution/#aggregation-semantics","title":"Aggregation semantics","text":"<p>The reference runtime aggregates the simulated per-run annual loss arrays using one of:</p> <ul> <li><code>sum</code>: elementwise sum</li> <li><code>max</code>: elementwise maximum</li> <li><code>mixture</code>: choose a scenario per run using weights (if provided)</li> <li><code>choose_one</code>: same selection mechanism as <code>mixture</code> (engine-defined distinction is currently minimal)</li> </ul> <p>These are implemented by <code>_aggregate_portfolio_losses</code>.</p>"},{"location":"Engine/Capabilities/Portfolio-Execution/#dependency-control-state-copula","title":"Dependency: control-state copula","text":"<p>The portfolio schema allows an optional <code>portfolio.dependency.copula</code> section.</p> <p>In the reference engine, this dependency is used to correlate binary control up/down state across controls.</p>"},{"location":"Engine/Capabilities/Portfolio-Execution/#supported-target-format","title":"Supported target format","text":"<p>Targets MUST be strings of the form:</p> <ul> <li><code>control:&lt;id&gt;:state</code></li> </ul> <p>This is validated in the portfolio planner before execution.</p>"},{"location":"Engine/Capabilities/Portfolio-Execution/#correlation-matrix-sources","title":"Correlation matrix sources","text":"<p>Two ways to define the correlation matrix:</p> <p>1) Provide an explicit matrix:</p> <pre><code>portfolio:\n  dependency:\n    copula:\n      type: gaussian\n      targets:\n        - control:cap:edr:state\n        - control:cap:mfa:state\n      matrix:\n        - [1.0, 0.5]\n        - [0.5, 1.0]\n</code></pre> <p>2) Provide Toeplitz structure (reference engine supports <code>structure: toeplitz</code>):</p> <pre><code>portfolio:\n  dependency:\n    copula:\n      type: gaussian\n      structure: toeplitz\n      rho: 0.65\n      targets:\n        - control:cap:edr:state\n        - control:cap:mfa:state\n</code></pre> <p>The planner expands this into an explicit matrix in the execution plan.</p>"},{"location":"Engine/Capabilities/Portfolio-Execution/#bundles","title":"Bundles","text":"<p>If you execute a <code>crml_portfolio_bundle: \"1.0\"</code>, the engine prefers inlined scenario documents from the bundle (to avoid filesystem dependence).</p>"},{"location":"Engine/Capabilities/Results/","title":"Engine capabilities: Results","text":"<p>The reference engine exposes two result representations:</p> <ul> <li>Engine-native: <code>crml_engine.models.result_model.SimulationResult</code></li> <li>Engine-agnostic result document: <code>crml_lang.models.simulation_result.CRSimulationResult</code> (<code>crml_simulation_result: \"1.0\"</code>)</li> </ul>"},{"location":"Engine/Capabilities/Results/#engine-native-result-simulationresult","title":"Engine-native result (<code>SimulationResult</code>)","text":"<p>The CLI (<code>crml simulate ...</code>) prints a formatted view of this result (or JSON via <code>--format json</code>).</p> <p>Fields (high level):</p> <ul> <li><code>success: bool</code></li> <li><code>metrics</code>: EAL, VaR, min/max/median/std</li> <li><code>distribution</code>: histogram bins/counts and optional raw samples (engine-defined)</li> <li><code>metadata</code>: run count, currency code/symbol, model meta, runtime ms, and some engine-specific fields</li> <li><code>errors: list[str]</code></li> </ul> <p>Model definition: crml_engine/src/crml_engine/models/result_model.py Model definition: <code>crml_engine/src/crml_engine/models/result_model.py</code></p>"},{"location":"Engine/Capabilities/Results/#result-document-crsimulationresult","title":"Result document (<code>CRSimulationResult</code>)","text":"<p>The envelope lives in <code>crml_lang</code> so engines and UIs can share a stable contract.</p> <ul> <li>Document discriminator: <code>crml_simulation_result: \"1.0\"</code></li> <li>Payload: <code>result</code> with <code>engine</code>, <code>run</code>, <code>inputs</code>, <code>units</code>, and structured <code>measures</code> + <code>artifacts</code></li> </ul> <p>Model definition: crml_lang/src/crml_lang/models/simulation_result.py Model definition: <code>crml_lang/src/crml_lang/models/simulation_result.py</code></p>"},{"location":"Engine/Capabilities/Results/#currency-and-units","title":"Currency and units","text":"<p>The reference engine reports currency using the FX config output currency:</p> <ul> <li><code>Metadata.currency_code</code> and <code>Metadata.currency</code> (symbol)</li> <li>Envelope <code>units.currency.code</code> and optional <code>units.currency.symbol</code></li> </ul> <p>FX configuration is engine-owned; see:</p> <ul> <li>Language/Schemas/FX-Config</li> <li>Multi-Currency Support</li> </ul>"},{"location":"Engine/Capabilities/Supported-Models/","title":"Engine capabilities: Supported models","text":"<p>This page documents what the reference engine (<code>crml_engine</code>) supports today.</p> <p>For the portable language contract, see: CRML Specification (Overview)</p>"},{"location":"Engine/Capabilities/Supported-Models/#inputs","title":"Inputs","text":"<p>The reference engine executes these CRML document types:</p> <ul> <li><code>crml_scenario: \"1.0\"</code></li> <li><code>crml_portfolio: \"1.0\"</code></li> <li><code>crml_portfolio_bundle: \"1.0\"</code></li> </ul>"},{"location":"Engine/Capabilities/Supported-Models/#scenario-frequency-models","title":"Scenario frequency models","text":"<p>Implemented in <code>crml_engine/src/crml_engine/simulation/frequency.py</code>.</p> <p>Supported <code>scenario.frequency.model</code> identifiers:</p> <ul> <li><code>poisson</code></li> <li><code>gamma</code></li> <li><code>hierarchical_gamma_poisson</code></li> </ul> <p>The portable basis semantics (<code>per_organization_per_year</code> vs <code>per_asset_unit_per_year</code>) are defined in CRML Specification (Overview).</p>"},{"location":"Engine/Capabilities/Supported-Models/#scenario-severity-models","title":"Scenario severity models","text":"<p>Implemented in <code>crml_engine/src/crml_engine/simulation/severity.py</code>.</p> <p>Supported <code>scenario.severity.model</code> identifiers:</p> <ul> <li><code>lognormal</code></li> <li><code>gamma</code></li> <li><code>mixture</code> (limited; see below)</li> </ul>"},{"location":"Engine/Capabilities/Supported-Models/#mixture-severity-limitation-important","title":"Mixture severity limitation (important)","text":"<p>The current reference implementation of <code>mixture</code> severity only uses the first component and ignores mixture weights.</p> <p>This is explicitly implemented in <code>SeverityEngine._generate_mixture_first_component</code>.</p>"},{"location":"Engine/Capabilities/Supported-Models/#portfolio-aggregation-semantics","title":"Portfolio aggregation semantics","text":"<p>Implemented in <code>crml_engine/src/crml_engine/runtime.py</code>.</p> <p>Supported <code>portfolio.semantics.method</code> values (execution-time semantics):</p> <ul> <li><code>sum</code></li> <li><code>max</code></li> <li><code>mixture</code></li> <li><code>choose_one</code></li> </ul>"},{"location":"Engine/Capabilities/Supported-Models/#multi-currency","title":"Multi-currency","text":"<p>The engine supports:</p> <ul> <li>Per-event severity currencies in scenarios (e.g., <code>USD</code>, <code>EUR</code>).</li> <li>Converting results into an output currency via an FX config.</li> </ul> <p>See: Multi-Currency Support</p>"},{"location":"Examples/Best-Practices/","title":"Best Practices","text":"<p>These patterns help you build CRML models that are maintainable, auditable, and portable.</p> <p>This guidance is engine agnostic and UI agnostic. Where workflows are mentioned, assume you can use CRML Studio to manage documents, run validation, and trigger risk modelling through your chosen engine.</p>"},{"location":"Examples/Best-Practices/#1-keep-scenarios-threat-centric-and-portable","title":"1) Keep scenarios threat-centric and portable","text":"<p>In CRML, a scenario is a threat-centric definition (frequency + severity + optional scenario-scoped control references).</p> <p>Best practice:</p> <ul> <li>Put the baseline threat model in a <code>crml_scenario: \"1.0\"</code> document.</li> <li>Do not embed exposure/inventory (asset counts) into the scenario.</li> </ul> <p>Why:</p> <ul> <li>You can reuse the same scenario across organizations and portfolios.</li> <li>You can compare \u201cthreat landscape\u201d separately from \u201corganizational posture\u201d.</li> </ul>"},{"location":"Examples/Best-Practices/#2-use-portfolios-for-exposure-aggregation-and-posture-we-call-this-callibration","title":"2) Use portfolios for exposure, aggregation, and posture (we call this callibration)","text":"<p>Use a <code>crml_portfolio: \"1.0\"</code> document to:</p> <ul> <li>Define assets/exposure (inventory cardinalities and tags).</li> <li>Combine multiple scenarios with an explicit semantics method (<code>sum</code>, <code>max</code>, <code>mixture</code>, <code>choose_one</code>).</li> <li>Express organizational control posture (directly or via catalog + assessment packs).</li> </ul> <p>In CRML Studio, this typically looks like:</p> <ol> <li>Create/import scenario documents.</li> <li>Create a portfolio representing your organisation and import the scenarios you want to simulate.</li> <li>Validate the portfolio (and optionally validate referenced scenarios).</li> <li>Run the simulation in your configured engine.</li> </ol>"},{"location":"Examples/Best-Practices/#3-treat-engine-defined-parts-as-explicit-assumptions","title":"3) Treat engine-defined parts as explicit assumptions","text":"<p>CRML intentionally does not standardize all modelling internals.</p> <ul> <li><code>scenario.frequency.model</code> and <code>scenario.severity.model</code> are engine-defined identifiers.</li> <li>Component structures (e.g., <code>severity.components</code>) may also be engine-defined.</li> </ul> <p>Best practice:</p> <ul> <li>Write down the intended interpretation in <code>meta.description</code> and/or in your project documentation.</li> <li>Prefer a small set of model identifiers across your organization to keep models comparable.</li> </ul>"},{"location":"Examples/Best-Practices/#4-prefer-human-auditable-parameterization","title":"4) Prefer human-auditable parameterization","text":"<p>For monetary severity inputs:</p> <ul> <li>Prefer <code>median</code> over <code>mu</code> when your engine supports it.</li> <li>Always include <code>currency</code> on monetary inputs.</li> </ul> <p>For numeric readability:</p> <ul> <li>Use ISO-style digit grouping strings (e.g., <code>\"100 000\"</code>) if your tooling supports \u201cnumberish\u201d parsing.</li> </ul>"},{"location":"Examples/Best-Practices/#5-model-controls-with-a-clean-separation-of-concerns","title":"5) Model controls with a clean separation of concerns","text":"<p>Practical control modelling usually requires three layers:</p> <ul> <li>Scenario layer: which controls are relevant to the threat (scenario control references).</li> <li>Catalog layer: canonical control IDs and definitions (control catalogs).</li> <li>Assessment layer: organization-specific implementation evidence (assessments).</li> </ul> <p>Best practice:</p> <ul> <li>Keep catalogs and assessments in their own documents.</li> <li>Reference those documents from a portfolio.</li> <li>Treat any \u201ccontrol effectiveness math\u201d as engine-defined unless standardized in your spec.</li> </ul>"},{"location":"Examples/Best-Practices/#6-keep-execution-time-config-out-of-band","title":"6) Keep execution-time config out-of-band","text":"<p>Some concerns are intentionally execution-time configuration, not risk-model content:</p> <ul> <li>FX/rates for currency conversion.</li> <li>Random seeds, run counts, and runtime-specific options.</li> </ul> <p>Best practice:</p> <ul> <li>Store these as separate config documents (or studio project settings), not in scenarios.</li> </ul>"},{"location":"Examples/Best-Practices/#7-document-limitations-explicitly","title":"7) Document limitations explicitly","text":"<p>Every \u201creal\u201d model has limitations. Make them part of the example:</p> <ul> <li>Which parts are standardized by CRML vs chosen by the engine/tool.</li> <li>Which parameters are sourced from data vs expert judgement.</li> <li>What\u2019s not modeled (e.g., second-order effects, tail dependencies, control degradation).</li> </ul>"},{"location":"Examples/By-Industry/","title":"Industry-Specific Examples","text":"<p>These examples illustrate an industry benchmarking / baseline quantification approach:</p> <ul> <li>Start from industry/regulatory data (threat landscape).</li> <li>Express a portable baseline as CRML scenarios.</li> <li>Build an organization-specific CRML portfolio that adds exposure (assets) and posture (controls).</li> </ul> <p>This page stays engine agnostic and UI agnostic. Assume CRML Studio can store the documents, run validation, and trigger risk modelling in your chosen engine.</p>"},{"location":"Examples/By-Industry/#documents-and-workflow","title":"Documents and workflow","text":"<p>Typical workflow:</p> <ol> <li>Create one or more scenarios per threat class (breach, ransomware, outage, fraud).</li> <li>Add industry tags, locale, and regulatory frameworks in <code>meta</code>.</li> <li>Create a portfolio:</li> <li>define assets/exposure</li> <li>reference scenarios</li> <li>optionally reference control catalogs and assessments</li> <li>Validate portfolio (and referenced scenarios) in CRML Studio.</li> <li>Run the portfolio through your engine.</li> </ol> <p>Important modelling rule:</p> <ul> <li>Scenarios do not contain \u201casset counts\u201d. Exposure is expressed in the portfolio (assets + scenario binding) or as an execution-time setting.</li> </ul>"},{"location":"Examples/By-Industry/#healthcare-example-phi-breach-baseline","title":"Healthcare example: PHI breach baseline","text":"<p>Scenario (threat-centric):</p> <pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"healthcare-phi-breach\"\n  description: \"Baseline PHI breach risk (illustrative numbers).\"\n  industries: [healthcare]\n  regulatory_frameworks: [HIPAA, HITECH]\n  locale:\n    regions: [north-america]\nscenario:\n  frequency:\n    basis: per_asset_unit_per_year\n    model: poisson\n    parameters:\n      lambda: 0.04\n  severity:\n    model: lognormal\n    parameters:\n      median: \"200 000\"\n      currency: USD\n      sigma: 1.5\n</code></pre> <p>Portfolio (exposure + aggregation):</p> <pre><code>crml_portfolio: \"1.0\"\nmeta:\n  name: \"healthcare-baseline\"\nportfolio:\n  semantics:\n    method: sum\n    constraints:\n      validate_scenarios: true\n  assets:\n    - name: phi_datastores\n      cardinality: 250\n      tags: [data, phi]\n  scenarios:\n    - id: phi_breach\n      path: ./healthcare-phi-breach.yaml\n      binding:\n        applies_to_assets: [phi_datastores]\n</code></pre>"},{"location":"Examples/By-Industry/#financial-services-example-pci-breach-baseline","title":"Financial services example: PCI breach baseline","text":"<pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"pci-breach\"\n  description: \"Payment card data breach baseline (illustrative numbers).\"\n  industries: [financial-services]\n  regulatory_frameworks: [\"PCI DSS\"]\n  locale:\n    regions: [north-america]\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters:\n      lambda: 0.03\n  severity:\n    model: lognormal\n    parameters:\n      median: \"1 000 000\"\n      currency: USD\n      sigma: 1.8\n</code></pre>"},{"location":"Examples/By-Industry/#saas-technology-example-outage-baseline","title":"SaaS / technology example: outage baseline","text":"<pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"saas-outage\"\n  description: \"Availability incident baseline (illustrative numbers).\"\n  industries: [technology]\n  locale:\n    regions: [north-america]\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters:\n      lambda: 3.0\n  severity:\n    model: lognormal\n    parameters:\n      median: \"270 000\"\n      currency: USD\n      sigma: 1.2\n</code></pre>"},{"location":"Examples/By-Industry/#making-the-baselines-organization-specific","title":"Making the baselines organization-specific","text":"<p>In a portfolio (not in the scenario), you typically adjust:</p> <ul> <li>Exposure: asset cardinalities and scenario bindings.</li> <li>Posture: reference control catalogs + assessments.</li> <li>Aggregation: how scenarios combine (<code>sum</code>, <code>max</code>, <code>mixture</code>, <code>choose_one</code>).</li> </ul>"},{"location":"Examples/By-Industry/#what-is-possible-today","title":"What is possible (today)","text":"<ul> <li>You can build an industry-tagged library of scenarios and reuse it across portfolios.</li> <li>You can enforce consistency by validating portfolios and referenced documents.</li> <li>You can keep controls as portable documents (catalogs/assessments) and reference them from portfolios.</li> </ul>"},{"location":"Examples/By-Industry/#limitations-assumptions","title":"Limitations / assumptions","text":"<ul> <li>Parameter choices (rates, medians, sigmas) come from your sources and judgement; CRML does not provide industry statistics.</li> <li>Frequency/severity model identifiers are engine-defined; ensure your engine supports the model IDs you use.</li> <li>How exposure scales \u201cper asset unit\u201d depends on the runtime/engine; document your engine\u2019s interpretation.</li> </ul>"},{"location":"Examples/FAIR-Baseline-Model/","title":"Example: FAIR-style Baseline Model","text":"<p>This page shows a FAIR-inspired \u201csingle scenario baseline\u201d expressed using the current CRML document structure.</p>"},{"location":"Examples/FAIR-Baseline-Model/#risk-management-approach","title":"Risk management approach","text":"<p>Use this approach when you want a transparent baseline that can support:</p> <ul> <li>initial quantification (\u201chow big is this category of loss?\u201d)</li> <li>sensitivity testing (\u201cwhat if frequency halves?\u201d)</li> <li>comparison over time (\u201cbefore vs after a control program\u201d) when combined with portfolios/controls</li> </ul>"},{"location":"Examples/FAIR-Baseline-Model/#documents-involved-engineui-agnostic","title":"Documents involved (engine/UI agnostic)","text":"<ul> <li>A Scenario (<code>crml_scenario: \"1.0\"</code>) that encodes baseline frequency + severity.</li> <li>A Portfolio (<code>crml_portfolio: \"1.0\"</code>) that selects scenarios and defines aggregation semantics.</li> </ul> <p>In CRML Studio, you typically create the scenario first, then build a portfolio that references it.</p>"},{"location":"Examples/FAIR-Baseline-Model/#example-scenario","title":"Example scenario","text":"<pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"fair-baseline\"\n  version: \"2025.1\"\n  description: \"FAIR-inspired baseline: Poisson frequency + lognormal severity.\"\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters:\n      lambda: 0.4\n  severity:\n    model: lognormal\n    parameters:\n      median: \"60 000\"\n      currency: USD\n      sigma: 1.0\n</code></pre>"},{"location":"Examples/FAIR-Baseline-Model/#example-portfolio-single-scenario","title":"Example portfolio (single-scenario)","text":"<pre><code>crml_portfolio: \"1.0\"\nmeta:\n  name: \"fair-baseline-portfolio\"\nportfolio:\n  semantics:\n    method: sum\n    constraints:\n      validate_scenarios: true\n  scenarios:\n    - id: baseline\n      path: ./fair-baseline.yaml\n</code></pre>"},{"location":"Examples/FAIR-Baseline-Model/#mapping-to-fair-concepts-practical-guidance","title":"Mapping to FAIR concepts (practical guidance)","text":"<p>Different teams map FAIR differently. A common, practical mapping is:</p> <ul> <li>Threat Event Frequency (TEF) \u2192 <code>frequency</code> (e.g., Poisson <code>lambda</code>)</li> <li>Loss Magnitude (LM) \u2192 <code>severity</code> (e.g., lognormal median + sigma)</li> </ul> <p>If you explicitly model \u201cvulnerability\u201d as a probability term in FAIR, you typically encode that either:</p> <ul> <li>inside <code>lambda</code> (baseline \u00d7 vulnerability factor), or</li> <li>via controls in a portfolio/runtime that reduces baseline likelihood.</li> </ul>"},{"location":"Examples/FAIR-Baseline-Model/#what-is-possible-today","title":"What is possible (today)","text":"<ul> <li>You can keep the baseline scenario portable and reuse it across portfolios.</li> <li>You can attach currency to monetary severity inputs.</li> <li>You can later add a portfolio-level control posture (catalogs + assessments) to support \u201cbefore/after\u201d analysis.</li> </ul>"},{"location":"Examples/FAIR-Baseline-Model/#limitations-assumptions","title":"Limitations / assumptions","text":"<ul> <li>CRML does not force a particular FAIR decomposition (TEF/VF/LM); that\u2019s a modelling choice.</li> <li>Distribution/model identifiers are engine-defined; your engine must support the chosen <code>model</code> names.</li> <li>Parameter estimation (data sources, calibration, priors) is not standardized by CRML; document your sources.</li> </ul>"},{"location":"Examples/Full-Examples/","title":"Full Examples","text":"<p>This page points to the repo\u2019s concrete example documents and explains how to use them for common risk-management workflows.</p> <p>Everything here is engine agnostic and UI agnostic: CRML defines the document contracts, while engines decide which model IDs and runtime features they support. Assume CRML Studio can be used to manage the documents, run validation, and trigger simulations/risk modelling through your configured engine.</p>"},{"location":"Examples/Full-Examples/#example-documents-in-this-repository","title":"Example documents in this repository","text":""},{"location":"Examples/Full-Examples/#scenarios-threat-centric","title":"Scenarios (threat-centric)","text":"<ul> <li>examples/scenarios/fair-baseline.yaml (FAIR-inspired baseline)</li> <li>examples/scenarios/data-breach-simple.yaml (simple breach baseline)</li> <li>examples/scenarios/ransomware-scenario.yaml (ransomware baseline)</li> <li>examples/scenarios/ransomware-with-controls.yaml (control-relevant threat)</li> <li>examples/scenarios/multi-currency-example.yaml (currency-tagged inputs)</li> <li>examples/scenarios/qber-simplified.yaml (QBER-inspired structure)</li> </ul>"},{"location":"Examples/Full-Examples/#portfolios-organization-view","title":"Portfolios (organization view)","text":"<ul> <li>examples/portfolios/portfolio.yaml (scenario aggregation, assets/exposure, control packs)</li> </ul>"},{"location":"Examples/Full-Examples/#control-catalogs-and-assessments","title":"Control catalogs and assessments","text":"<ul> <li>examples/control_catalogs/control-catalog.yaml</li> <li>examples/control_assessments/control-assessment.yaml (Assessment pack)</li> </ul>"},{"location":"Examples/Full-Examples/#fx-config-execution-time","title":"FX config (execution-time)","text":"<ul> <li>examples/fx_configs/fx-config.yaml</li> <li>examples/fx_configs/fx-config-eur.yaml</li> </ul>"},{"location":"Examples/Full-Examples/#practical-workflows-how-teams-typically-use-these","title":"Practical workflows (how teams typically use these)","text":""},{"location":"Examples/Full-Examples/#baseline-quantification","title":"Baseline quantification","text":"<ol> <li>Start with a baseline scenario (e.g., FAIR-style).</li> <li>Create a one-scenario portfolio that references it.</li> <li>Validate and run.</li> <li>Capture assumptions and data sources in the scenario <code>meta</code>.</li> </ol>"},{"location":"Examples/Full-Examples/#portfolio-aggregation-enterprise-view","title":"Portfolio aggregation (enterprise view)","text":"<ol> <li>Create multiple scenarios for distinct threat classes.</li> <li>Build a portfolio with explicit aggregation semantics.</li> <li>Add assets/exposure and bind scenarios to the relevant assets if applicable.</li> </ol>"},{"location":"Examples/Full-Examples/#controlposture-driven-analysis","title":"Control/posture driven analysis","text":"<ol> <li>Maintain canonical control IDs in a control catalog.</li> <li>Track organization evidence in an assessment catalog.</li> <li>Reference both from the portfolio.</li> <li>Ensure each scenario declares which controls are relevant (scenario controls).</li> </ol>"},{"location":"Examples/Full-Examples/#multi-currency-reporting","title":"Multi-currency reporting","text":"<ol> <li>Tag severity inputs with their currency.</li> <li>Provide an external FX config at execution time.</li> </ol>"},{"location":"Examples/Full-Examples/#limitations-and-portability-notes","title":"Limitations and portability notes","text":"<ul> <li>Scenario/portfolio schemas are strict; avoid adding engine-specific keys into the CRML documents unless your tooling explicitly supports that.</li> <li>Model identifiers are engine-defined; not every engine will support <code>mixture</code> or hierarchical frequency models.</li> <li>\u201cPipelines\u201d (MCMC, diagnostics, exports) are deliberately outside the CRML core documents; treat them as engine/tool configuration.</li> </ul>"},{"location":"Examples/QBER-Enterprise-Model/","title":"Example: QBER-style Enterprise Model","text":"<p>This page describes how to represent a \u201cQBER-inspired\u201d enterprise model using CRML documents.</p>"},{"location":"Examples/QBER-Enterprise-Model/#risk-management-approach","title":"Risk management approach","text":"<p>Use this approach when you want to combine:</p> <ul> <li>a portfolio/inventory view of the enterprise (assets/exposure)</li> <li>richer frequency/severity model choices (often Bayesian/hierarchical)</li> <li>traceable assumptions and inputs (data sources, feature mappings)</li> </ul>"},{"location":"Examples/QBER-Enterprise-Model/#what-crml-can-express-vs-what-is-enginetool-defined","title":"What CRML can express vs what is engine/tool-defined","text":"<p>CRML can express:</p> <ul> <li>Scenario structure: frequency model ID + parameters, severity model ID + parameters/components.</li> <li>Optional data source metadata and feature mapping.</li> <li>Portfolio structure: assets, scenario references, aggregation semantics, optional relationships/dependencies.</li> </ul> <p>Engine/tool-defined (not standardized by CRML):</p> <ul> <li>The semantics of specific model IDs (e.g., <code>hierarchical_gamma_poisson</code>).</li> <li>How \u201ccriticality index\u201d is computed and how it influences model parameters.</li> <li>Any Bayesian inference / MCMC pipeline and diagnostics.</li> </ul> <p>In CRML Studio, treat engine/tool-defined pieces as a project-level contract: choose an engine that supports the model IDs you use, and keep the assumptions visible.</p>"},{"location":"Examples/QBER-Enterprise-Model/#example-scenario-qber-inspired","title":"Example scenario (QBER-inspired)","text":"<pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"qber-inspired\"\n  version: \"2025.1\"\n  description: \"QBER-inspired: hierarchical frequency + mixture severity (engine-defined).\"\ndata:\n  sources:\n    pam:\n      type: pam\n      data_schema:\n        priv_escalations: int\n        rotation_failures: int\n  feature_mapping:\n    pam_entropy: pam.pam_entropy\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: hierarchical_gamma_poisson\n    parameters:\n      alpha_base: 2.0\n      beta_base: 1.0\n  severity:\n    model: mixture\n    parameters: {}\n    components:\n      - lognormal:\n          weight: 0.7\n          median: \"162 755\"\n          currency: USD\n          sigma: 1.2\n      - gamma:\n          weight: 0.3\n          shape: 2.5\n          scale: \"10 000\"\n          currency: USD\n</code></pre>"},{"location":"Examples/QBER-Enterprise-Model/#example-portfolio-enterprise-exposure-aggregation","title":"Example portfolio (enterprise exposure + aggregation)","text":"<pre><code>crml_portfolio: \"1.0\"\nmeta:\n  name: \"enterprise-qber-inspired\"\nportfolio:\n  semantics:\n    method: sum\n    constraints:\n      validate_scenarios: true\n\n  assets:\n    - name: endpoints\n      cardinality: 10000\n      tags: [it, endpoint]\n      criticality_index:\n        type: entropy-weighted\n        inputs:\n          pam_entropy: pam_entropy\n        weights:\n          pam_entropy: 1.0\n\n  scenarios:\n    - id: enterprise_loss\n      path: ./qber-inspired.yaml\n</code></pre>"},{"location":"Examples/QBER-Enterprise-Model/#what-is-possible-today","title":"What is possible (today)","text":"<ul> <li>You can represent \u201cQBER-style\u201d structure and assumptions as CRML documents.</li> <li>You can keep the engine-specific logic outside the language while still making it auditable.</li> <li>You can combine the model with control catalogs/assessments in the portfolio to express posture.</li> </ul>"},{"location":"Examples/QBER-Enterprise-Model/#limitations-assumptions","title":"Limitations / assumptions","text":"<ul> <li>CRML does not define how Bayesian inference is performed; engines/tools decide.</li> <li>Some engines will ignore or partially support complex component structures.</li> <li>Any link between asset criticality and model parameters is engine-defined and must be documented.</li> </ul>"},{"location":"Examples/Spec-Examples/","title":"Specification Examples","text":"<p>This page highlights small, spec-level examples using the current CRML document contracts.</p> <p>In this repository:</p> <ul> <li>Scenario documents use <code>crml_scenario: \"1.0\"</code>.</li> <li>Portfolio documents use <code>crml_portfolio: \"1.0\"</code>.</li> <li>FX config is an execution-time config document (<code>crml_fx_config: \"1.0\"</code>).</li> </ul> <p>For full, runnable examples, see Full Examples.</p>"},{"location":"Examples/Spec-Examples/#scenario-document-header","title":"Scenario document header","text":"<pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"example\"\n  version: \"2025.1\"\n  description: \"Short description.\"\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters:\n      lambda: 0.2\n  severity:\n    model: lognormal\n    parameters:\n      median: \"100 000\"\n      currency: USD\n      sigma: 1.2\n</code></pre>"},{"location":"Examples/Spec-Examples/#median-based-parameterization-recommended","title":"Median-based parameterization (recommended)","text":"<p>Using <code>median</code> is often more auditable than <code>mu</code>:</p> <pre><code>severity:\n  model: lognormal\n  parameters:\n    median: \"250 000\"\n    currency: EUR\n    sigma: 1.2\n</code></pre>"},{"location":"Examples/Spec-Examples/#multi-currency-inputs-external-fx-config","title":"Multi-currency inputs + external FX config","text":"<p>CRML scenarios can tag monetary inputs with a currency. FX rates are not embedded into the risk model; they are supplied at execution time.</p> <p>FX config document:</p> <pre><code>crml_fx_config: \"1.0\"\nbase_currency: USD\noutput_currency: EUR\nrates:\n  USD: 1.0\n  EUR: 1.08\n</code></pre>"},{"location":"Examples/Spec-Examples/#portfolio-document-header","title":"Portfolio document header","text":"<pre><code>crml_portfolio: \"1.0\"\nmeta:\n  name: \"example-portfolio\"\nportfolio:\n  semantics:\n    method: sum\n    constraints:\n      validate_scenarios: true\n  scenarios:\n    - id: s1\n      path: ./scenario.yaml\n</code></pre>"},{"location":"Examples/Spec-Examples/#limitations-and-portability-notes","title":"Limitations and portability notes","text":"<ul> <li>Model identifiers (e.g., <code>poisson</code>, <code>mixture</code>) are engine-defined.</li> <li>Component structures (e.g., <code>severity.components</code>) are engine-defined.</li> <li>Any inference pipelines, exports, or runtime options belong in engine/tool configuration, not in the CRML documents.</li> </ul>"},{"location":"Guides/Add-New-Distribution/","title":"Add new distribution (engine developer guide)","text":"<p>This guide explains how to add a new frequency or severity model to the reference engine.</p>"},{"location":"Guides/Add-New-Distribution/#1-choose-a-model-identifier","title":"1) Choose a model identifier","text":"<p>Model identifiers are engine-defined strings used in scenario documents:</p> <ul> <li><code>scenario.frequency.model</code></li> <li><code>scenario.severity.model</code></li> </ul>"},{"location":"Guides/Add-New-Distribution/#2-implement-generation-logic","title":"2) Implement generation logic","text":"<ul> <li>Frequency models live in <code>crml_engine/src/crml_engine/simulation/frequency.py</code></li> <li>Severity models live in <code>crml_engine/src/crml_engine/simulation/severity.py</code></li> </ul>"},{"location":"Guides/Add-New-Distribution/#3-register-support","title":"3) Register support","text":"<p>The engine rejects unknown models in <code>_validate_supported_models</code>.</p> <p>See: <code>crml_engine/src/crml_engine/simulation/engine.py</code></p>"},{"location":"Guides/Add-New-Distribution/#4-add-tests","title":"4) Add tests","text":"<p>Add tests under <code>tests/crml_engine/</code> to lock in behavior.</p>"},{"location":"Guides/Add-New-Distribution/#5-update-docs","title":"5) Update docs","text":"<ul> <li>Add the model to: Engine capabilities: Supported models</li> <li>If needed, update the conceptual pages under Concepts</li> </ul>"},{"location":"Guides/Calibrate-from-Data/","title":"Calibrate from data","text":"<p>Calibration converts organization-specific evidence (incident losses, telemetry-derived estimates) into scenario parameters.</p> <p>CRML treats calibration as engine/tool responsibility; the language defines where calibrated parameters live in documents.</p>"},{"location":"Guides/Calibrate-from-Data/#lognormal-calibration-from-single_losses","title":"Lognormal calibration from <code>single_losses</code>","text":"<p>The reference engine supports calibrating lognormal parameters from empirical single-event losses.</p>"},{"location":"Guides/Calibrate-from-Data/#python","title":"Python","text":"<pre><code>from crml_engine.runtime import calibrate_lognormal_from_single_losses\nfrom crml_engine.models.fx_model import get_default_fx_config\n\nfx = get_default_fx_config()\nmu, sigma = calibrate_lognormal_from_single_losses(\n    single_losses=[12000, 18000, 25000, 9000, 40000],\n    currency=\"USD\",\n    base_currency=fx.base_currency,\n    fx_config=fx,\n)\nprint(mu, sigma)\n</code></pre>"},{"location":"Guides/Calibrate-from-Data/#scenario-yaml-engine-defined","title":"Scenario YAML (engine-defined)","text":"<p>Some engines may also accept <code>single_losses</code> inside the lognormal parameters and calibrate automatically.</p> <p>See: Runtime (Severity)</p>"},{"location":"Guides/Excel-Controls-and-Mappings/","title":"Excel workflows: control definitions and mappings","text":"<p>CRML supports authoring control definitions (control catalogs) and control-to-control mappings (control relationships packs) in a strict XLSX workbook format.</p> <p>This is intended for workflows where subject-matter experts maintain controls/mappings in Excel, while tools/engines consume CRML YAML.</p>"},{"location":"Guides/Excel-Controls-and-Mappings/#install-xlsx-support","title":"Install XLSX support","text":"<p>The XLSX import/export feature lives in <code>crml_lang</code> and requires the optional dependency <code>openpyxl</code>.</p> <pre><code>pip install \"crml-lang[xlsx]\"\n</code></pre>"},{"location":"Guides/Excel-Controls-and-Mappings/#recommended-workflow-round-trip","title":"Recommended workflow (round-trip)","text":""},{"location":"Guides/Excel-Controls-and-Mappings/#1-generate-a-template-workbook-or-export-existing-yaml","title":"1) Generate a template workbook (or export existing YAML)","text":"<p>You can generate an empty workbook with the correct sheet names and headers:</p> <pre><code>python -m crml_lang.mapping export-xlsx --out controls-and-mappings.xlsx\n</code></pre> <p>Or export existing CRML YAML documents into a workbook:</p> <pre><code>python -m crml_lang.mapping export-xlsx \\\n  --out controls-and-mappings.xlsx \\\n  --control-catalog examples/control_catalogs/control-catalog.yaml \\\n  --control-relationships examples/control_relationships/cisv8-mappings.yaml\n</code></pre> <p>Windows note: if your system uses <code>py</code> instead of <code>python</code>, use <code>py -m crml_lang.mapping ...</code>.</p>"},{"location":"Guides/Excel-Controls-and-Mappings/#2-edit-in-excel","title":"2) Edit in Excel","text":"<p>Open the workbook and edit only the rows in these sheets:</p> <ul> <li><code>control_catalogs</code> (control definitions)</li> <li><code>control_relationships</code> (control mappings)</li> </ul> <p>You may ignore the other sheets if you don\u2019t need them.</p> <p>Important rules:</p> <ul> <li>Do not rename sheets.</li> <li>Do not delete the <code>_meta</code> sheet.</li> <li>Keep the first header row intact (it is usually hidden). The workbook uses two header rows:</li> <li>Row 1: machine keys (hidden)</li> <li>Row 2: human labels (visible)</li> </ul> <p>If you create new columns, rename columns, or delete the hidden header row, import will fail.</p>"},{"location":"Guides/Excel-Controls-and-Mappings/#sheet-control_catalogs-control-definitions","title":"Sheet: <code>control_catalogs</code> (control definitions)","text":"<p>Each non-empty row defines one control entry and is grouped into documents by <code>doc_*</code> fields + <code>catalog_id</code>.</p> <p>Required fields for a usable row:</p> <ul> <li><code>doc_name</code> (Document name)</li> <li><code>framework</code> (Framework)</li> <li><code>control_id</code> (Control id)</li> </ul> <p>Common fields:</p> <ul> <li><code>title</code>, <code>url</code></li> <li><code>tags_json</code> (JSON array, e.g. <code>[\"hardening\",\"baseline\"]</code>)</li> <li><code>defense_in_depth_layers_json</code> (JSON array, allowed values: <code>prevent</code>, <code>detect</code>, <code>respond</code>, <code>recover</code>)</li> </ul> <p>Optional structured locator (<code>ref_*</code>):</p> <ul> <li><code>ref_standard</code> + <code>ref_control</code> are required together if either is used</li> <li><code>ref_requirement</code> is optional</li> </ul> <p>Notes:</p> <ul> <li>Keep <code>id</code> values stable (e.g. <code>cisv8:4.2</code>, <code>org:edr</code>). These are what portfolios/assessments reference.</li> <li>Avoid embedding copyrighted standard text in titles/descriptions.</li> </ul>"},{"location":"Guides/Excel-Controls-and-Mappings/#sheet-control_relationships-control-mappings","title":"Sheet: <code>control_relationships</code> (control mappings)","text":"<p>Each non-empty row defines one source \u2192 target mapping and is grouped into documents by <code>doc_*</code> fields + <code>pack_id</code>.</p> <p>Required fields:</p> <ul> <li><code>doc_name</code></li> <li><code>source_id</code></li> <li><code>target_id</code></li> <li><code>overlap_weight</code> (number in <code>[0,1]</code>)</li> </ul> <p>Optional fields:</p> <ul> <li><code>relationship_type</code> (enum): <code>overlaps_with</code>, <code>mitigates</code>, <code>supports</code>, <code>equivalent_to</code>, <code>parent_of</code>, <code>child_of</code>, <code>backstops</code></li> <li><code>confidence</code> (number in <code>[0,1]</code>)</li> <li><code>overlap_dimensions_json</code> (JSON map, e.g. <code>{ \"coverage\": 0.9 }</code>)</li> <li><code>groupings_json</code> (JSON array of objects)</li> <li><code>references_json</code> (JSON array of objects)</li> <li><code>description</code>, <code>overlap_rationale</code></li> </ul> <p>Practical tip:</p> <ul> <li>Keep rows for the same <code>source_id</code> adjacent (e.g. sort by <code>doc_name</code>, then <code>pack_id</code>, then <code>source_id</code>). This keeps the imported YAML grouped 1\u2192N in a clean way.</li> </ul>"},{"location":"Guides/Excel-Controls-and-Mappings/#import-back-to-crml-yaml","title":"Import back to CRML YAML","text":"<pre><code>python -m crml_lang.mapping import-xlsx \\\n  --in controls-and-mappings.xlsx \\\n  --out-dir imported/ \\\n  --overwrite\n</code></pre> <p>This writes one YAML file per imported document into <code>imported/</code>.</p> <p>Validation (optional but recommended):</p> <ul> <li>If you have <code>crml</code> CLI installed: <code>crml validate imported/&lt;file&gt;.yaml</code></li> <li>Or validate from Python using <code>crml_lang.validate_*</code> helpers.</li> </ul>"},{"location":"Guides/Excel-Controls-and-Mappings/#using-the-imported-yaml-in-portfolios","title":"Using the imported YAML in portfolios","text":"<p>Portfolios reference control catalogs and relationship packs by path:</p> <pre><code>portfolio:\n  control_catalogs:\n    - imported/my-catalog-control-catalog.yaml\n  control_relationships:\n    - imported/my-mappings-control-relationships.yaml\n</code></pre>"},{"location":"Guides/Executive-Reporting/","title":"Executive reporting","text":"<p>This guide focuses on how to communicate CRML simulation outputs.</p>"},{"location":"Guides/Executive-Reporting/#common-measures","title":"Common measures","text":"<ul> <li>EAL: expected annual loss (mean)</li> <li>VaR 95% / 99% / 99.9%: tail percentiles</li> </ul> <p>These are available in the reference engine\u2019s <code>SimulationResult.metrics</code>.</p> <p>See: Engine capabilities: Results</p>"},{"location":"Guides/Executive-Reporting/#portfolio-rollups","title":"Portfolio rollups","text":"<p>Portfolios allow you to report across multiple scenarios and exposures.</p> <p>See: Engine capabilities: Portfolio execution</p>"},{"location":"Guides/Tool-Integration/","title":"Tool integration","text":"<p>This guide covers common integration surfaces.</p>"},{"location":"Guides/Tool-Integration/#json-output-cli","title":"JSON output (CLI)","text":"<pre><code>crml simulate model.yaml --runs 20000 --format json &gt; result.json\n</code></pre>"},{"location":"Guides/Tool-Integration/#python-integration","title":"Python integration","text":"<ul> <li>Language-level validation/loading: Language Python API</li> <li>Runtime execution: Engine Python API</li> </ul>"},{"location":"Guides/Tool-Integration/#bundles-for-portability","title":"Bundles for portability","text":"<p>If you need to run an engine without filesystem dependencies, use a <code>crml_portfolio_bundle</code>.</p> <p>See:</p> <ul> <li>Language/Schemas/Portfolio-Bundle</li> <li>Engine capabilities: Portfolio execution</li> </ul>"},{"location":"Guides/Understanding-Parameters/","title":"Understanding parameters","text":"<p>This guide gives practical intuition for common CRML parameters.</p> <p>For the portable semantics and document shapes, see:</p> <ul> <li>CRML Specification (Overview)</li> <li>Scenario schema</li> </ul>"},{"location":"Guides/Understanding-Parameters/#frequency-lambda","title":"Frequency (<code>lambda</code>)","text":"<p>For a Poisson frequency model, <code>lambda</code> is the expected number of events per year in the configured basis.</p> <ul> <li>If basis is <code>per_organization_per_year</code>, <code>lambda</code> is the org-wide expected annual event count.</li> <li>If basis is <code>per_asset_unit_per_year</code>, the effective annual rate is scaled by bound exposure E.</li> </ul> <p>See: Runtime (Frequency)</p>"},{"location":"Guides/Understanding-Parameters/#severity-lognormal","title":"Severity (lognormal)","text":"<p>Common parameters:</p> <ul> <li><code>median</code>: median single-event loss</li> <li><code>sigma</code>: log-space spread</li> <li><code>currency</code>: currency code</li> </ul> <p>See: Runtime (Severity)</p>"},{"location":"Guides/Understanding-Parameters/#simulation-runs","title":"Simulation runs","text":"<p>Percentile estimates (VaR) stabilize more slowly than means.</p> <ul> <li>Use smaller <code>--runs</code> while iterating.</li> <li>Increase runs for reporting.</li> </ul>"},{"location":"Guides/Writing-CRML/","title":"Writing CRML models","text":"<p>This guide describes how to author CRML inputs in this repo\u2019s document-oriented format.</p> <p>Start here if you are new:</p> <ul> <li>Quickstart</li> <li>CRML Specification (Overview)</li> </ul>"},{"location":"Guides/Writing-CRML/#the-core-split-scenario-vs-portfolio","title":"The core split: scenario vs portfolio","text":"<ul> <li>A scenario (<code>crml_scenario: \"1.0\"</code>) describes one risk model (frequency + severity + optional referenced controls).</li> <li>A portfolio (<code>crml_portfolio: \"1.0\"</code>) describes exposure (assets, cardinalities) and binds scenarios to assets.</li> </ul> <p>Schemas:</p> <ul> <li>Scenario</li> <li>Portfolio</li> </ul>"},{"location":"Guides/Writing-CRML/#minimal-scenario","title":"Minimal scenario","text":"<pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"phishing\"\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters: {lambda: 0.1}\n  severity:\n    model: lognormal\n    parameters: {median: 22000, currency: USD, sigma: 1.0}\n</code></pre>"},{"location":"Guides/Writing-CRML/#exposure-scaling","title":"Exposure scaling","text":"<p>If you want \u201cper asset unit per year\u201d semantics, set:</p> <ul> <li><code>scenario.frequency.basis: per_asset_unit_per_year</code></li> </ul> <p>Then bind the scenario to portfolio assets so exposure cardinality E is defined.</p> <p>The portable rules are specified here:</p> <ul> <li>Exposure scaling and frequency basis</li> </ul>"},{"location":"Guides/Writing-CRML/#controls","title":"Controls","text":"<p>Scenarios can reference controls by id; portfolios provide measured values for those ids.</p> <p>See:</p> <ul> <li>Control effectiveness</li> <li>Engine capabilities: Controls</li> </ul>"},{"location":"Guides/Writing-CRML/#validate-early","title":"Validate early","text":"<p>Use validation frequently while authoring:</p> <pre><code>crml validate my.yaml\n</code></pre> <p>See: Validation</p>"},{"location":"Language/Installation/","title":"Language installation (<code>crml_lang</code>)","text":"<p>Install the language package:</p> <pre><code>pip install crml-lang\n</code></pre> <p>Optional extras:</p> <ul> <li>Excel mapping support: <code>pip install \"crml-lang[xlsx]\"</code></li> </ul> <p>This package does not provide the <code>crml</code> simulation CLI; that comes from <code>crml-engine</code>.</p>"},{"location":"Language/Overview/","title":"Language overview (<code>crml_lang</code>)","text":"<p><code>crml_lang</code> defines the portable CRML language contract:</p> <ul> <li>Document schemas (JSON Schema generated from Pydantic models)</li> <li>YAML load/dump helpers</li> <li>Validation (schema + semantic checks)</li> <li>Engine-agnostic interchange models (e.g., result envelope)</li> </ul> <p>Engines (like <code>crml_engine</code>) decide which modeling algorithms are supported and how to execute them.</p> <p>See: CRML Specification (Overview)</p>"},{"location":"Language/Overview/#document-types","title":"Document types","text":"<p>CRML is document-oriented. Common document discriminators include:</p> <ul> <li><code>crml_scenario: \"1.0\"</code></li> <li><code>crml_portfolio: \"1.0\"</code></li> <li><code>crml_control_catalog: \"1.0\"</code></li> <li><code>crml_assessment: \"1.0\"</code></li> <li><code>crml_control_relationships: \"1.0\"</code></li> <li><code>crml_attack_catalog: \"1.0\"</code></li> <li><code>crml_attack_control_relationships: \"1.0\"</code></li> <li><code>crml_portfolio_bundle: \"1.0\"</code></li> <li><code>crml_simulation_result: \"1.0\"</code></li> </ul> <p>Schema docs live under: Language/Schemas</p>"},{"location":"Language/Python-API/","title":"Language Python API (<code>crml_lang</code>)","text":"<p><code>crml_lang</code> is the supported import surface for loading and validating CRML documents.</p>"},{"location":"Language/Python-API/#load-and-dump-yaml","title":"Load and dump YAML","text":""},{"location":"Language/Python-API/#scenario","title":"Scenario","text":"<pre><code>from crml_lang import CRScenario\n\nscenario = CRScenario.load_from_yaml(\"examples/scenarios/scenario-phishing.yaml\")\nprint(scenario.meta.name)\n\nyaml_text = scenario.dump_to_yaml_str()\n</code></pre>"},{"location":"Language/Python-API/#portfolio","title":"Portfolio","text":"<pre><code>from crml_lang import CRPortfolio\n\nportfolio = CRPortfolio.load_from_yaml(\"examples/portfolios/portfolio.yaml\")\nprint(portfolio.meta.name)\n</code></pre>"},{"location":"Language/Python-API/#validate-documents","title":"Validate documents","text":""},{"location":"Language/Python-API/#validate-any-document-type","title":"Validate any document type","text":"<pre><code>from crml_lang import validate_document\n\nreport = validate_document(\"examples/scenarios/scenario-phishing.yaml\", source_kind=\"path\")\nprint(report.render_text(source_label=\"scenario-phishing.yaml\"))\n</code></pre>"},{"location":"Language/Python-API/#validate-portfolios-with-semantic-checks","title":"Validate portfolios (with semantic checks)","text":"<pre><code>from crml_lang import validate_portfolio\n\nreport = validate_portfolio(\"examples/portfolios/portfolio.yaml\", source_kind=\"path\")\nif not report.ok:\n    raise SystemExit(report.render_text(source_label=\"portfolio.yaml\"))\n</code></pre> <p>Notes:</p> <ul> <li><code>validate_document</code> detects the document type by top-level discriminator keys.</li> <li>Validation includes schema errors and semantic warnings.</li> </ul>"},{"location":"Language/Validation/","title":"Validation","text":"<p>CRML validation in this repo happens in two layers:</p> <ol> <li>Schema validation (JSON Schema)</li> <li>Semantic validation (cross-field and cross-document checks)</li> </ol> <p>The canonical implementation lives in <code>crml_lang.validators</code>.</p>"},{"location":"Language/Validation/#validate-any-document","title":"Validate any document","text":"<p>Use <code>validate_document</code> to validate any supported CRML document type.</p> <pre><code>from crml_lang import validate_document\n\nreport = validate_document(\"doc.yaml\", source_kind=\"path\")\nif not report.ok:\n    print(report.render_text(source_label=\"doc.yaml\"))\n</code></pre> <p>Type detection is based on top-level discriminator keys (e.g., <code>crml_scenario</code>, <code>crml_portfolio</code>, ...).</p>"},{"location":"Language/Validation/#portfolio-semantic-checks","title":"Portfolio semantic checks","text":"<p>Portfolio validation includes additional semantic checks such as:</p> <ul> <li>Ensuring referenced document types are consistent.</li> <li>Exposure/binding consistency checks (when cross-document inputs can be loaded).</li> <li>Constraints implied by the spec (e.g., portfolios that reference assessments must also reference control catalogs).</li> </ul> <p>The portable semantics are documented in:</p> <ul> <li>CRML Specification (Overview)</li> </ul>"},{"location":"Language/Validation/#cli-validation","title":"CLI validation","text":"<p>The engine CLI delegates validation to <code>crml_lang</code>:</p> <pre><code>crml validate examples/scenarios/scenario-phishing.yaml\n</code></pre> <p>See: Engine CLI</p>"},{"location":"Language/Schemas/Assessment/","title":"Assessment Schema (<code>crml_assessment: \"1.0\"</code>)","text":"<p>This page documents the CRML Assessment document shape and how to use it.</p> <ul> <li>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-assessment-schema.json</code></li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/assessment_model.py</code> (<code>CRAssessment</code>)</li> </ul>"},{"location":"Language/Schemas/Assessment/#what-an-assessment-is","title":"What an assessment is","text":"<p>An assessment is an organization/tool-produced control posture dataset.</p> <p>Per control, an assessment entry MUST provide exactly one of:</p> <ul> <li>Quantitative posture fields: <code>implementation_effectiveness</code> and/or <code>coverage</code> and/or <code>reliability</code></li> <li>SCF Capability Maturity Model (CMM): <code>scf_cmm_level</code> (0..5)</li> </ul> <p>Entries MUST NOT mix both styles in the same control.</p> <p>Assessments can be referenced from a portfolio. When a portfolio references assessments, it should also reference the corresponding control catalogs.</p>"},{"location":"Language/Schemas/Assessment/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_assessment: \"1.0\"\nmeta: { ... }\nassessment:\n  framework: \"...\"\n  assessed_at: \"...\"  # optional\n  assessments: [ ... ]\n</code></pre>"},{"location":"Language/Schemas/Assessment/#minimal-example","title":"Minimal example","text":"<pre><code>crml_assessment: \"1.0\"\nmeta:\n  name: \"Example assessment\"\nassessment:\n  framework: \"Org\"\n  assessed_at: \"2025-12-17T10:15:30Z\"\n  assessments:\n    - id: \"org:iam.mfa\"\n      scf_cmm_level: 3 # Well-Defined\n</code></pre> <p>See also: <code>examples/control_assessments/control-assessment.yaml</code>.</p>"},{"location":"Language/Schemas/Assessment/#assessment-catalog-fields","title":"Assessment catalog fields","text":"<ul> <li><code>assessment.id</code> (optional): identifier for the assessment dataset</li> <li><code>assessment.framework</code> (required): framework label (for humans/tools)</li> <li><code>assessment.assessed_at</code> (optional): ISO 8601 timestamp</li> <li><code>assessment.assessments</code> (required): list of per-control entries</li> </ul>"},{"location":"Language/Schemas/Assessment/#per-control-assessment-entry","title":"Per-control assessment entry","text":"<p>Each entry supports:</p> <ul> <li><code>id</code> (required): canonical control id</li> <li>Either quantitative posture fields:</li> <li><code>implementation_effectiveness</code> (optional, 0..1)</li> <li><code>coverage</code> (optional): <code>{ value: 0..1, basis: &lt;string&gt; }</code></li> <li> <p><code>reliability</code> (optional, 0..1)</p> </li> <li> <p>Or SCF maturity:</p> </li> <li><code>scf_cmm_level</code> (optional, 0..5):</li> <li>0 \u2013 Not Performed</li> <li>1 \u2013 Performed Informally</li> <li>2 \u2013 Planned &amp; Tracked</li> <li>3 \u2013 Well-Defined</li> <li>4 \u2013 Quantitatively Controlled</li> <li>5 \u2013 Continuously Improving</li> <li><code>question</code> (optional): prompt text for questionnaires</li> <li><code>description</code> (optional): extra context (avoid copyrighted standard text)</li> <li><code>notes</code> (optional)</li> <li><code>ref</code> (optional): structured locator metadata (tools/UI)</li> </ul>"},{"location":"Language/Schemas/Assessment/#using-assessments-in-portfolios","title":"Using assessments in portfolios","text":"<p>A portfolio references assessments by path:</p> <pre><code>portfolio:\n  control_catalogs:\n    - ../control_catalogs/control-catalog.yaml\n  assessments:\n    - ../control_assessments/control-assessment.yaml\n</code></pre> <p>Semantic rule:</p> <ul> <li>If <code>portfolio.assessments</code> is provided, <code>portfolio.control_catalogs</code> must also be provided.</li> </ul>"},{"location":"Language/Schemas/Assessment/#validation","title":"Validation","text":"<p>Python:</p> <pre><code>from crml_lang import validate_assessment\nreport = validate_assessment(\"examples/control_assessments/control-assessment.yaml\", source_kind=\"path\")\nassert report.ok\n</code></pre>"},{"location":"Language/Schemas/Attack-Catalog/","title":"Attack Catalog Schema (<code>crml_attack_catalog: \"1.0\"</code>)","text":"<p>This page documents the CRML Attack Catalog document shape and how to use it.</p> <ul> <li>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-attack-catalog-schema.json</code></li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/attack_catalog_model.py</code> (<code>CRAttackCatalog</code>)</li> </ul>"},{"location":"Language/Schemas/Attack-Catalog/#what-an-attack-catalog-is","title":"What an attack catalog is","text":"<p>An attack catalog is a metadata pack for attack-pattern identifiers.</p> <p>Typical uses:</p> <ul> <li>Provide stable ids and human labels for UI/tooling</li> <li>Provide optional URLs/tags for navigation and grouping</li> <li>Serve as a reference set that scenarios/portfolios/tools can point at</li> </ul> <p>Attack catalogs are intentionally non-executable and engine-agnostic.</p>"},{"location":"Language/Schemas/Attack-Catalog/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_attack_catalog: \"1.0\"\nmeta: { ... }\ncatalog: { ... }\n</code></pre>"},{"location":"Language/Schemas/Attack-Catalog/#catalog","title":"<code>catalog</code>","text":"<p>The catalog contains entries keyed by a stable identifier.</p> <p>Exact fields are defined by the schema; open the schema JSON file for authoritative field-by-field constraints:</p> <ul> <li><code>crml_lang/src/crml_lang/schemas/crml-attack-catalog-schema.json</code></li> </ul>"},{"location":"Language/Schemas/Attack-Catalog/#validation","title":"Validation","text":"<p>CLI:</p> <pre><code>crml validate path/to/attack-catalog.yaml\n</code></pre> <p>Python:</p> <pre><code>from crml_lang import validate_document\n\nreport = validate_document(\"path/to/attack-catalog.yaml\", source_kind=\"path\")\nprint(report.ok)\n</code></pre>"},{"location":"Language/Schemas/Attack-Control-Relationships/","title":"Attack\u2192Control Relationships Schema (<code>crml_attack_control_relationships: \"1.0\"</code>)","text":"<p>This page documents the CRML Attack\u2192Control Relationships document type.</p> <ul> <li>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-attack-control-relationships-schema.json</code></li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/attack_control_relationships_model.py</code> (<code>CRAttackControlRelationships</code>)</li> </ul>"},{"location":"Language/Schemas/Attack-Control-Relationships/#what-an-attackcontrol-relationships-mapping-is","title":"What an attack\u2192control relationships mapping is","text":"<p>An attack\u2192control relationships mapping is a portable set of grouped mappings from an attack-pattern id (e.g., ATT&amp;CK) to one or more control ids.</p> <p>It is intended to support workflows like:</p> <ul> <li>a scenario (or dataset) references attack ids (e.g., <code>attck:T1059.003</code>),</li> <li>tools/engines translate these into candidate controls (<code>cisv8:...</code>, <code>iso27001:...</code>, <code>org:...</code>),</li> <li>the mapping provides provenance, relationship type, and optional strength/confidence.</li> </ul> <p>CRML does not mandate attack\u2192attack mappings (e.g., ATT&amp;CK\u2194CAPEC). If you need those, that is an engine/tool responsibility.</p>"},{"location":"Language/Schemas/Attack-Control-Relationships/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_attack_control_relationships: \"1.0\"\nmeta: { ... }\nrelationships:\n  id: \"...\"              # optional\n  relationships: [ ... ]\n  metadata: { ... }       # optional\n</code></pre>"},{"location":"Language/Schemas/Attack-Control-Relationships/#relationship-mapping-grouped-1n","title":"Relationship mapping (grouped 1\u2192N)","text":"<p>Each mapping entry groups all control targets for a single attack id:</p> <ul> <li><code>attack</code> (required): attack-pattern id (recommended namespace: <code>attck</code>)</li> <li><code>targets</code> (required): non-empty list of target entries</li> </ul>"},{"location":"Language/Schemas/Attack-Control-Relationships/#target-entry","title":"Target entry","text":"<p>Each target entry has:</p> <ul> <li><code>control</code> (required): canonical control id (<code>namespace:key</code>)</li> <li><code>relationship_type</code> (required): one of</li> <li><code>mitigated_by</code></li> <li><code>detectable_by</code></li> <li><code>respondable_by</code></li> <li><code>strength</code> (optional, 0..1): tool/community-defined strength metric</li> <li><code>confidence</code> (optional, 0..1): tool/community-defined confidence</li> <li><code>description</code> (optional): free-form description (avoid copyrighted text)</li> <li><code>references</code> (optional): provenance pointers</li> <li><code>tags</code> (optional): tool tags</li> </ul>"},{"location":"Language/Schemas/Attack-Control-Relationships/#minimal-example","title":"Minimal example","text":"<pre><code>crml_attack_control_relationships: \"1.0\"\nmeta:\n  name: \"Example attack\u2192control mappings\"\nrelationships:\n  id: \"example-mapping\"\n  relationships:\n    - attack: \"attck:T1059.003\"\n      targets:\n        - control: \"cisv8:8.2\"\n          relationship_type: mitigated_by\n          strength: 0.7\n          confidence: 0.8\n          references:\n            - type: url\n              url: https://example.com/mapping-notes\n</code></pre>"},{"location":"Language/Schemas/Attack-Control-Relationships/#using-attackcontrol-relationships-in-portfolios","title":"Using attack\u2192control relationships in portfolios","text":"<p>A portfolio may reference these mappings by path:</p> <pre><code>portfolio:\n  attack_control_relationships:\n    - ../attack_control_relationships/attck-to-controls.yaml\n</code></pre>"},{"location":"Language/Schemas/Attack-Control-Relationships/#validation","title":"Validation","text":"<p>Python:</p> <pre><code>from crml_lang import validate_attack_control_relationships\nreport = validate_attack_control_relationships(\"path/to/mapping.yaml\", source_kind=\"path\")\nassert report.ok\n</code></pre> <p>````</p>"},{"location":"Language/Schemas/Control-Catalog/","title":"Control Catalog Schema (<code>crml_control_catalog: \"1.0\"</code>)","text":"<p>This page documents the CRML Control Catalog document shape and how to use it.</p> <ul> <li>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-control-catalog-schema.json</code></li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/control_catalog_model.py</code> (<code>CRControlCatalog</code>)</li> </ul>"},{"location":"Language/Schemas/Control-Catalog/#what-a-control-catalog-is","title":"What a control catalog is","text":"<p>A control catalog is a portable list of canonical control ids with lightweight metadata.</p> <p>It is designed for:</p> <ul> <li>tools to display and group controls,</li> <li>portfolios/assessments to share a consistent set of ids,</li> <li>avoiding any need to embed copyrighted standard text.</li> </ul>"},{"location":"Language/Schemas/Control-Catalog/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_control_catalog: \"1.0\"\nmeta: { ... }\ncatalog:\n  framework: \"...\"\n  controls: [ ... ]\n</code></pre>"},{"location":"Language/Schemas/Control-Catalog/#minimal-example","title":"Minimal example","text":"<pre><code>crml_control_catalog: \"1.0\"\nmeta:\n  name: \"Example control catalog\"\ncatalog:\n  id: \"org\"\n  framework: \"Org\"\n  controls:\n    - id: \"org:iam.mfa\"\n      title: \"Multi-factor authentication\"\n      tags: [\"iam\"]\n    - id: \"org:edr\"\n      title: \"Endpoint detection and response\"\n      tags: [\"endpoint\", \"detection\"]\n</code></pre> <p>See also: <code>examples/control_catalogs/control-catalog.yaml</code>.</p>"},{"location":"Language/Schemas/Control-Catalog/#catalog-fields","title":"Catalog fields","text":"<ul> <li><code>catalog.id</code> (optional): organization/community identifier for the catalog</li> <li><code>catalog.framework</code> (required): free-form label for humans/tools (e.g. <code>CIS v8</code>, <code>ISO27001:2022</code>, <code>Org</code>)</li> <li><code>catalog.controls</code> (required): list of <code>ControlCatalogEntry</code></li> </ul>"},{"location":"Language/Schemas/Control-Catalog/#control-entry-fields","title":"Control entry fields","text":"<p>Each entry is intentionally minimal:</p> <ul> <li><code>id</code> (required): canonical id (<code>namespace:key</code>)</li> <li><code>title</code> (optional): short human-readable label</li> <li><code>url</code> (optional): pointer to reference material</li> <li><code>tags</code> (optional): free-form tags</li> <li><code>ref</code> (optional): structured locator metadata for tools</li> <li><code>defense_in_depth_layers</code> (optional): list of layer tags with allowed values: <code>prevent</code>, <code>detect</code>, <code>respond</code>, <code>recover</code></li> </ul>"},{"location":"Language/Schemas/Control-Catalog/#defense_in_depth_layers-defense-in-depth","title":"<code>defense_in_depth_layers</code> (defense-in-depth)","text":"<p>Optional metadata to help tools and humans represent defense-in-depth in a portfolio/catalog.</p> <p>This field allows multiple tags per control, but only from a fixed set of values.</p> <p>Example:</p> <pre><code>- id: \"org:siem\"\n  defense_in_depth_layers: [\"detect\", \"respond\"]\n</code></pre>"},{"location":"Language/Schemas/Control-Catalog/#ref-structured-locator","title":"<code>ref</code> (structured locator)","text":"<p><code>ref</code> is optional metadata for mapping/linking to an external standard. It is not the canonical reference mechanism; use <code>id</code>.</p> <p>Current shape:</p> <pre><code>ref:\n  standard: \"CIS\"   # required\n  control: \"2\"      # required\n  requirement: \"...\"  # optional free-form requirement text (avoid copyrighted text)\n</code></pre> <p>Notes:</p> <ul> <li><code>requirement</code> is optional free-form text. Only include requirement text you have rights to share.</li> <li>The standard/version/granularity should be encoded in the canonical <code>id</code>.</li> </ul>"},{"location":"Language/Schemas/Control-Catalog/#validation","title":"Validation","text":""},{"location":"Language/Schemas/Control-Catalog/#excel-xlsx-authoring","title":"Excel (XLSX) authoring","text":"<p>If you prefer maintaining control definitions in Excel, CRML supports a strict XLSX workbook workflow and round-tripping to YAML:</p> <ul> <li>Guide: Excel Controls &amp; Mappings</li> </ul> <p>Python:</p> <pre><code>from crml_lang import validate_control_catalog\nreport = validate_control_catalog(\"examples/control_catalogs/control-catalog.yaml\", source_kind=\"path\")\nassert report.ok\n</code></pre>"},{"location":"Language/Schemas/Control-Relationships/","title":"Control Relationships Schema (<code>crml_control_relationships: \"1.0\"</code>)","text":"<p>This page documents the CRML Control Relationships document shape and how to use it.</p> <ul> <li>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-control-relationships-schema.json</code></li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/control_relationships_model.py</code> (<code>CRControlRelationships</code>)</li> </ul>"},{"location":"Language/Schemas/Control-Relationships/#what-a-control-relationships-pack-is","title":"What a control relationships pack is","text":"<p>A control relationships pack is a portable set of grouped control-to-control mappings (1 to n) with quantitative overlap metadata.</p> <p>It is intended to support workflows like:</p> <ul> <li>a scenario references control id <code>A</code> (threat-centric),</li> <li>a portfolio implements control id <code>B</code> (implementation-centric),</li> <li>the pack provides a mapping describing how each implemented <code>B</code> relates to <code>A</code> (e.g. overlap or equivalence), so engines/tools can reason about mitigation.</li> </ul>"},{"location":"Language/Schemas/Control-Relationships/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_control_relationships: \"1.0\"\nmeta: { ... }\nrelationships:\n  id: \"...\"           # optional\n  relationships: [ ... ]\n</code></pre>"},{"location":"Language/Schemas/Control-Relationships/#relationship-mapping-grouped-1n","title":"Relationship mapping (grouped 1\u2192N)","text":"<p>Each mapping entry groups all targets for a single source:</p> <ul> <li><code>source</code> (required): canonical control id (often scenario/threat-centric)</li> <li><code>targets</code> (required): non-empty list of target entries</li> </ul>"},{"location":"Language/Schemas/Control-Relationships/#target-entry","title":"Target entry","text":"<p>Each target entry has:</p> <ul> <li><code>target</code> (required): canonical control id (often portfolio/implementation-centric)</li> <li><code>relationship_type</code> (optional): one of</li> <li><code>overlaps_with</code>, <code>mitigates</code>, <code>supports</code>, <code>equivalent_to</code>, <code>parent_of</code>, <code>child_of</code>, <code>backstops</code></li> <li><code>overlap</code> (required): quantitative overlap metadata</li> <li><code>confidence</code> (optional, 0..1)</li> <li><code>groupings</code> (optional): framework-agnostic taxonomy tags</li> <li><code>description</code> (optional): free-form description (avoid copyrighted text)</li> <li><code>references</code> (optional): provenance pointers</li> </ul>"},{"location":"Language/Schemas/Control-Relationships/#overlap","title":"<code>overlap</code>","text":"<p><code>overlap.weight</code> is required and must be in <code>[0, 1]</code>.</p> <p>Recommended semantics:</p> <ul> <li><code>weight</code> is the fraction of the source control\u2019s objective covered by the target.</li> </ul> <p>Optional:</p> <ul> <li><code>dimensions</code>: named sub-weights (tool/community-defined)</li> <li><code>rationale</code>: explanation (avoid copyrighted text)</li> </ul>"},{"location":"Language/Schemas/Control-Relationships/#minimal-example","title":"Minimal example","text":"<pre><code>crml_control_relationships: \"1.0\"\nmeta:\n  name: \"Example mapping pack\"\nrelationships:\n  id: \"org-mapping\"\n  relationships:\n    - source: \"cisv8:4.2\"\n      targets:\n        - target: \"org:edr\"\n          relationship_type: overlaps_with\n          overlap:\n            weight: 0.75\n          confidence: 0.8\n          references:\n            - type: url\n              url: https://example.com/mapping-notes\n</code></pre>"},{"location":"Language/Schemas/Control-Relationships/#using-control-relationships-in-portfolios","title":"Using control relationships in portfolios","text":"<p>A portfolio references packs by path:</p> <pre><code>portfolio:\n  control_relationships:\n    - ../control_relationships/mapping-pack.yaml\n</code></pre> <p>Engines/tools may use these packs to resolve scenario controls to portfolio controls when ids are in different namespaces.</p>"},{"location":"Language/Schemas/Control-Relationships/#validation","title":"Validation","text":""},{"location":"Language/Schemas/Control-Relationships/#excel-xlsx-authoring","title":"Excel (XLSX) authoring","text":"<p>If you prefer maintaining control mappings in Excel, CRML supports a strict XLSX workbook workflow and round-tripping to YAML:</p> <ul> <li>Guide: Excel Controls &amp; Mappings</li> </ul> <p>Python:</p> <pre><code>from crml_lang import validate_control_relationships\nreport = validate_control_relationships(\"path/to/pack.yaml\", source_kind=\"path\")\nassert report.ok\n</code></pre>"},{"location":"Language/Schemas/FX-Config/","title":"FX Config Schema (<code>crml_fx_config: \"1.0\"</code>) (engine-owned)","text":"<p>This page documents the reference engine\u2019s FX config document.</p> <ul> <li>JSON Schema: <code>crml_engine/src/crml_engine/schemas/crml-fx-config-schema.json</code></li> <li>Loader/model: <code>crml_engine/src/crml_engine/models/fx_model.py</code></li> </ul> <p>This document is engine-owned (runtime configuration), not part of the core CRML language.</p>"},{"location":"Language/Schemas/FX-Config/#what-an-fx-config-is","title":"What an FX config is","text":"<p>An FX config defines:</p> <ul> <li>the base currency used for internal normalization,</li> <li>the output currency used for reporting,</li> <li>conversion rates.</li> </ul> <p>It is used by the reference engine to convert monetary severity inputs/outputs.</p>"},{"location":"Language/Schemas/FX-Config/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_fx_config: \"1.0\"\nbase_currency: USD\noutput_currency: USD\nrates: { USD: 1.0, EUR: 1.08 }\nas_of: \"2025-01-15\"  # optional\n</code></pre> <p>The schema allows additional engine-defined keys (<code>additionalProperties: true</code>).</p>"},{"location":"Language/Schemas/FX-Config/#minimal-example","title":"Minimal example","text":"<p>See: <code>examples/fx_configs/fx-config.yaml</code></p>"},{"location":"Language/Schemas/FX-Config/#using-fx-config-with-the-cli","title":"Using FX config with the CLI","text":"<p>Typical usage:</p> <ul> <li>Provide the file to the engine at runtime with <code>--fx-config</code>.</li> </ul> <p>Example:</p> <ul> <li><code>crml simulate examples/portfolios/portfolio.yaml --fx-config examples/fx_configs/fx-config.yaml</code></li> </ul> <p>(Exact CLI subcommand/flags depend on the installed CLI version; this repository\u2019s examples follow the reference engine.)</p>"},{"location":"Language/Schemas/FX-Config/#validation-behavior","title":"Validation behavior","text":"<p>The reference engine:</p> <ul> <li>validates the file against its JSON Schema (generated from the model),</li> <li>merges provided rates with defaults,</li> <li>warns and falls back to defaults if the file cannot be loaded.</li> </ul> <p>If you need strict behavior (fail hard), implement that policy in your tooling/CI wrapper.</p>"},{"location":"Language/Schemas/Portfolio-Bundle/","title":"Portfolio Bundle Schema (<code>crml_portfolio_bundle: \"1.0\"</code>)","text":"<p>This page documents the CRML Portfolio Bundle artifact shape and how to use it.</p> <ul> <li>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-portfolio-bundle-schema.json</code></li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/portfolio_bundle.py</code> (<code>CRPortfolioBundle</code>)</li> </ul>"},{"location":"Language/Schemas/Portfolio-Bundle/#what-a-portfolio-bundle-is","title":"What a portfolio bundle is","text":"<p>A portfolio bundle is a language-produced artifact that inlines a portfolio and all referenced documents into a single self-contained object.</p> <p>Key properties:</p> <ul> <li>Intended as the contract between <code>crml_lang</code> and engines.</li> <li>Designed so engines do not need filesystem access (everything is inlined).</li> </ul> <p>Most users should not hand-author bundles; they are produced by tooling (e.g., <code>crml_lang.bundle</code>).</p>"},{"location":"Language/Schemas/Portfolio-Bundle/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_portfolio_bundle: \"1.0\"\nportfolio_bundle:\n  portfolio: { ... }\n  scenarios: [ ... ]\n  control_catalogs: [ ... ]\n  assessments: [ ... ]\n  control_relationships: [ ... ]\n  warnings: [ ... ]\n  metadata: { ... }\n</code></pre>"},{"location":"Language/Schemas/Portfolio-Bundle/#key-sections","title":"Key sections","text":""},{"location":"Language/Schemas/Portfolio-Bundle/#portfolio_bundleportfolio","title":"<code>portfolio_bundle.portfolio</code>","text":"<p>The full inlined portfolio document (<code>CRPortfolio</code>).</p>"},{"location":"Language/Schemas/Portfolio-Bundle/#portfolio_bundlescenarios","title":"<code>portfolio_bundle.scenarios</code>","text":"<p>A list of inlined scenarios with portfolio ids:</p> <ul> <li><code>id</code>: scenario id from the portfolio</li> <li><code>weight</code>: optional</li> <li><code>source_path</code>: traceability only</li> <li><code>scenario</code>: the full inlined scenario document</li> </ul>"},{"location":"Language/Schemas/Portfolio-Bundle/#control_catalogs-assessments-control_relationships","title":"<code>control_catalogs</code>, <code>assessments</code>, <code>control_relationships</code>","text":"<p>Inlined documents corresponding to any packs referenced by the portfolio.</p>"},{"location":"Language/Schemas/Portfolio-Bundle/#warnings","title":"<code>warnings</code>","text":"<p>Non-fatal bundling warnings; tools should surface these to users.</p>"},{"location":"Language/Schemas/Portfolio-Bundle/#metadata","title":"<code>metadata</code>","text":"<p>Free-form traceability metadata; engines should not interpret it.</p>"},{"location":"Language/Schemas/Portfolio-Bundle/#minimal-skeleton-example","title":"Minimal skeleton example","text":"<pre><code>crml_portfolio_bundle: \"1.0\"\nportfolio_bundle:\n  portfolio: { crml_portfolio: \"1.0\", meta: {name: \"...\"}, portfolio: { ... } }\n  scenarios:\n    - id: phishing\n      scenario: { crml_scenario: \"1.0\", meta: {name: \"...\"}, scenario: { ... } }\n  control_catalogs: []\n  assessments: []\n  control_relationships: []\n  warnings: []\n  metadata: {}\n</code></pre>"},{"location":"Language/Schemas/Portfolio-Bundle/#validation","title":"Validation","text":"<p>Python:</p> <pre><code>from crml_lang.models.portfolio_bundle import CRPortfolioBundle\nbundle = CRPortfolioBundle.model_validate(bundle_dict)\n</code></pre>"},{"location":"Language/Schemas/Portfolio/","title":"Portfolio Schema (<code>crml_portfolio: \"1.0\"</code>)","text":"<p>This page documents the CRML Portfolio document shape and how to use it.</p> <ul> <li>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-portfolio-schema.json</code></li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/portfolio_model.py</code> (<code>CRPortfolio</code>)</li> </ul>"},{"location":"Language/Schemas/Portfolio/#what-a-portfolio-is","title":"What a portfolio is","text":"<p>A portfolio provides exposure (assets and cardinalities) and binds one or more scenarios to that exposure.</p> <p>Portfolios may also reference control packs (catalogs, assessments, mappings) so engines/tools can apply control posture and do cross-framework resolution.</p>"},{"location":"Language/Schemas/Portfolio/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_portfolio: \"1.0\"\nmeta: { ... }\nportfolio: { ... }\n</code></pre>"},{"location":"Language/Schemas/Portfolio/#minimal-example","title":"Minimal example","text":"<pre><code>crml_portfolio: \"1.0\"\nmeta:\n  name: \"Example portfolio\"\nportfolio:\n  semantics:\n    method: sum\n    constraints:\n      require_paths_exist: true\n      validate_scenarios: true\n  assets:\n    - name: employees\n      cardinality: 250\n    - name: endpoints\n      cardinality: 450\n  scenarios:\n    - id: phishing\n      path: ../scenarios/scenario-phishing.yaml\n      binding:\n        applies_to_assets: [employees]\n</code></pre> <p>See also: <code>examples/portfolios/portfolio.yaml</code>.</p>"},{"location":"Language/Schemas/Portfolio/#portfoliosemantics","title":"<code>portfolio.semantics</code>","text":"<pre><code>semantics:\n  method: sum | mixture | choose_one | max\n  constraints:\n    require_paths_exist: &lt;bool&gt;\n    validate_scenarios: &lt;bool&gt;\n    validate_relevance: &lt;bool&gt;\n</code></pre> <p>Notes:</p> <ul> <li><code>method</code> determines how scenario losses are aggregated (engine uses this as guidance).</li> <li><code>constraints</code> influence validation behavior in tools:</li> <li><code>require_paths_exist</code>: if true, referenced file paths must exist during validation</li> <li><code>validate_scenarios</code>: if true, referenced scenarios are schema-validated during portfolio validation</li> <li><code>validate_relevance</code>: enables extra checks using <code>meta</code> context</li> </ul>"},{"location":"Language/Schemas/Portfolio/#portfolioassets","title":"<code>portfolio.assets</code>","text":"<p>Each asset is an exposure bucket.</p> <pre><code>assets:\n  - name: endpoints\n    cardinality: 450\n    tags: [\"it\", \"endpoint\"]\n</code></pre> <p>Notes:</p> <ul> <li><code>name</code> must be unique in the portfolio.</li> <li><code>cardinality</code> is parsed leniently (some numberish inputs are accepted).</li> </ul>"},{"location":"Language/Schemas/Portfolio/#portfolioscenarios-references-bindings","title":"<code>portfolio.scenarios</code> (references + bindings)","text":"<p>Each scenario reference includes:</p> <ul> <li><code>id</code>: unique id within the portfolio</li> <li><code>path</code>: file path to the scenario document</li> <li><code>binding.applies_to_assets</code> (optional): list of asset names defining the exposure set</li> <li><code>weight</code> (optional): used by some aggregation methods</li> </ul> <p>Example:</p> <pre><code>scenarios:\n  - id: phishing\n    path: ../scenarios/scenario-phishing.yaml\n    binding:\n      applies_to_assets: [employees]\n</code></pre> <p>Binding semantics are standardized in <code>wiki/Reference/CRML-Specification.md</code> (Exposure scaling section).</p>"},{"location":"Language/Schemas/Portfolio/#portfoliocontrols-optional-inventory","title":"<code>portfolio.controls</code> (optional inventory)","text":"<p>Portfolios MAY define controls directly:</p> <pre><code>controls:\n  - id: org:iam.mfa\n    implementation_effectiveness: 0.7\n    coverage: { value: 0.9, basis: employees }\n    reliability: 0.99\n    affects: frequency\n</code></pre> <p>Many workflows instead rely on assessment packs for posture values.</p>"},{"location":"Language/Schemas/Portfolio/#referencing-control-packs","title":"Referencing control packs","text":"<p>Portfolios can reference external documents by path:</p> <ul> <li><code>control_catalogs</code>: list of control catalog files</li> <li><code>assessments</code>: list of assessment files</li> <li><code>control_relationships</code>: list of control relationship pack files</li> </ul> <p>Important semantic rule:</p> <ul> <li>If <code>portfolio.assessments</code> is used, <code>portfolio.control_catalogs</code> must also be provided (so assessment ids can be interpreted consistently).</li> </ul>"},{"location":"Language/Schemas/Portfolio/#scenario-to-scenario-relationships-optional","title":"Scenario-to-scenario relationships (optional)","text":"<p><code>portfolio.relationships</code> supports:</p> <ul> <li>correlation edges (<code>type: correlation</code>, <code>between: [a, b]</code>, <code>value: -1..1</code>)</li> <li>conditional edges (<code>type: conditional</code>, <code>given: a</code>, <code>then: b</code>, <code>probability: 0..1</code>)</li> </ul>"},{"location":"Language/Schemas/Portfolio/#dependency-modeling-optional","title":"Dependency modeling (optional)","text":"<p>Portfolios can specify an engine-independent copula structure:</p> <pre><code>dependency:\n  copula:\n    type: gaussian\n    targets:\n      - \"control:org:iam.mfa:state\"\n      - \"control:org:edr:state\"\n    structure: toeplitz\n    rho: 0.35\n</code></pre>"},{"location":"Language/Schemas/Portfolio/#validation","title":"Validation","text":"<p>Python:</p> <pre><code>from crml_lang import validate_portfolio\nreport = validate_portfolio(\"examples/portfolios/portfolio.yaml\", source_kind=\"path\")\nassert report.ok\n</code></pre> <p>For exact constraints, consult <code>crml_lang/src/crml_lang/schemas/crml-portfolio-schema.json</code>.</p>"},{"location":"Language/Schemas/Scenario/","title":"Scenario Schema (<code>crml_scenario: \"1.0\"</code>)","text":"<p>This page documents the CRML Scenario document shape and provides two authoring workflows:</p> <ul> <li>Profile A (Threat report baseline): fast authoring from threat reports and news.</li> <li> <p>Profile B (Internal calibration): calibrate/validate using internal incident and loss data.</p> </li> <li> <p>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-scenario-schema.json</code></p> </li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/scenario_model.py</code> (<code>CRScenario</code>)</li> </ul>"},{"location":"Language/Schemas/Scenario/#what-a-scenario-is","title":"What a scenario is","text":"<p>A scenario is a portable threat/risk model made of:</p> <ul> <li><code>scenario.frequency</code>: how often the threat event occurs</li> <li><code>scenario.severity</code>: how large the loss is per event</li> </ul> <p>A scenario is not executable on its own: execution happens in a portfolio, which provides exposure (assets/cardinalities) and binds scenarios to that exposure.</p> <p>Practical interpretation:</p> <ul> <li>You can author a scenario from external reporting (baseline).</li> <li>You can later refine it with internal evidence and calibrate the parameters.</li> </ul>"},{"location":"Language/Schemas/Scenario/#top-level-structure","title":"Top-level structure","text":"<p>Required:</p> <pre><code>crml_scenario: \"1.0\"\nmeta: { ... }\nscenario: { ... }\n</code></pre> <p>Optional:</p> <ul> <li><code>evidence:</code> citations + lightweight observed metrics (recommended for threat-report authoring)</li> <li><code>data:</code> internal data integration hook (recommended for calibration tooling)</li> </ul>"},{"location":"Language/Schemas/Scenario/#profile-a-threat-report-baseline-recommended-starting-point","title":"Profile A: Threat report baseline (recommended starting point)","text":"<p>Use this profile when your inputs are mostly from threat reports/news:</p> <ul> <li>narrative + targeting (industry/region)</li> <li>observed counts over a time window (sometimes)</li> <li>a typical loss number or range (sometimes)</li> <li>recommended mitigations (almost always)</li> </ul>"},{"location":"Language/Schemas/Scenario/#what-to-fill","title":"What to fill","text":"<p>1) Put provenance into <code>evidence.sources</code> (URLs, vendor report names, dates).</p> <p>2) Set frequency as a baseline:</p> <ul> <li>Prefer <code>basis: per_organization_per_year</code> for externally sourced intelligence.</li> <li><code>frequency.model</code> is optional; if omitted it defaults to <code>poisson</code>.</li> <li>Set <code>frequency.parameters.lambda</code> to a reasonable baseline per year.</li> </ul> <p>3) Set severity minimally:</p> <ul> <li>Prefer <code>severity.parameters.median</code> for human authoring.</li> <li>Choose a reasonable <code>sigma</code> if you don\u2019t have internal data yet.</li> </ul> <p>4) List recommended relevant controls in <code>scenario.controls</code>.</p>"},{"location":"Language/Schemas/Scenario/#example-baseline-from-reporting","title":"Example (baseline from reporting)","text":"<pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"Phishing -&gt; account takeover\"\n  description: \"Baseline scenario authored from external reporting; calibrate with internal incidents when available.\"\n  tags: [\"threat-report\", \"phishing\", \"ato\"]\n  industries: [\"cross-industry\"]\n  attck: [\"attck:T1566\"]\n\nevidence:\n  sources:\n    - title: \"Example Threat Report 2025\"\n      publisher: \"Vendor X\"\n      url: \"https://example.com/report\"\n      published_at: \"2025-09-01\"\n      retrieved_at: \"2025-12-18\"\n      notes: \"Used for incident frequency and typical loss guidance.\"\n  observed:\n    window: { start: \"2024-01-01\", end: \"2024-12-31\" }\n    incident_count: 120\n    org_count: 500\n    currency: USD\n    loss_median: 20000\n    loss_p90: 150000\n\nscenario:\n  controls:\n    - id: \"org:iam.mfa\"\n    - id: \"org:mail.phishing_training\"\n  frequency:\n    basis: per_organization_per_year\n    parameters:\n      lambda: 0.8\n  severity:\n    model: lognormal\n    parameters:\n      currency: USD\n      median: 20000\n      sigma: 1.2\n</code></pre> <p>Implementation note:</p> <ul> <li>A tool can optionally derive \\lambda from evidence like:   $\\lambda \\approx \\frac{\\text{incident\\_count}}{\\text{org\\_count} \\cdot \\text{years}}$   and then write it back into <code>scenario.frequency.parameters.lambda</code>.</li> </ul>"},{"location":"Language/Schemas/Scenario/#profile-b-internal-calibration-incident-and-loss-data","title":"Profile B: Internal calibration (incident and loss data)","text":"<p>Use this profile when you have internal data sources (incident logs, ticket exports, loss accounting) and you want to:</p> <ul> <li>validate that your baseline model roughly matches reality</li> <li>calibrate \\lambda and severity parameters</li> </ul>"},{"location":"Language/Schemas/Scenario/#what-to-fill_1","title":"What to fill","text":"<p>1) Keep <code>evidence</code> for provenance (optional but recommended).</p> <p>2) Describe internal datasets in <code>data.sources</code> and map fields with <code>data.feature_mapping</code>.</p> <p>3) Calibrate severity using per-incident losses:</p> <ul> <li>populate <code>scenario.severity.parameters.single_losses</code> (portable, no engine-specific feature naming)</li> </ul> <p>4) Calibrate frequency:</p> <ul> <li>update <code>scenario.frequency.parameters.lambda</code></li> </ul>"},{"location":"Language/Schemas/Scenario/#example-calibration-oriented","title":"Example (calibration-oriented)","text":"<pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"Phishing -&gt; account takeover (calibrated)\"\n  tags: [\"internal-calibrated\", \"phishing\", \"ato\"]\n\ndata:\n  sources:\n    org_incidents_2022_2025:\n      type: incident_log_csv\n      data_schema:\n        occurred_at: datetime\n        loss_usd: money\n        scenario_label: string\n  feature_mapping:\n    incident_timestamp: occurred_at\n    incident_loss_amount: loss_usd\n\nscenario:\n  controls:\n    - id: \"org:iam.mfa\"\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters:\n      lambda: 1.3\n  severity:\n    model: lognormal\n    parameters:\n      currency: USD\n      single_losses: [12000, 5000, 90000, 18000, 24000]\n</code></pre>"},{"location":"Language/Schemas/Scenario/#evidence-citations-lightweight-observed-metrics","title":"<code>evidence</code> (citations + lightweight observed metrics)","text":"<p>The optional top-level <code>evidence</code> section is designed to match what threat reports/news provide.</p> <p>Use it to store:</p> <ul> <li>citations (<code>evidence.sources</code>)</li> <li>coarse observed counts and summary loss statistics (<code>evidence.observed</code>)</li> </ul> <p>Tools can use <code>evidence</code> to help compute model parameters, but the executable model remains <code>scenario.frequency</code> + <code>scenario.severity</code>.</p> <p>Important constraints:</p> <ul> <li><code>evidence</code> is portable metadata; it should not contain secrets.</li> <li>Date/timestamps are stored as ISO 8601 strings.</li> </ul>"},{"location":"Language/Schemas/Scenario/#data-data-sources-and-feature-mapping","title":"<code>data</code> (data sources and feature mapping)","text":"<p>The optional top-level <code>data</code> section is an integration hook for tools and engines.</p> <p>It is designed for workflows where an organization wants to attach internal datasets that can be used to calibrate or validate the scenario.</p> <p>Important constraints:</p> <ul> <li>The CRML language validates the shape of <code>data</code>, but does not standardize source <code>type</code> strings or feature names.</li> <li>Engines and UIs SHOULD treat <code>data</code> as optional and ignore unknown feature names.</li> <li>Do not put secrets (API keys, credentials) into CRML documents.</li> </ul>"},{"location":"Language/Schemas/Scenario/#datasources","title":"<code>data.sources</code>","text":"<p><code>data.sources</code> is an optional map of named sources. Each source has:</p> <ul> <li><code>type</code>: engine/UI-defined identifier (e.g. <code>csv</code>, <code>parquet</code>, <code>snowflake</code>, <code>servicenow_export</code>, <code>siem_incidents</code>)</li> <li><code>data_schema</code> (optional): a free-form mapping describing fields available in that source</li> </ul> <p>Notes:</p> <ul> <li><code>sources</code> deliberately does not include a portable <code>path</code>/<code>uri</code> field. Tools that need locations should handle that out-of-band to keep CRML portable.</li> </ul>"},{"location":"Language/Schemas/Scenario/#datafeature_mapping","title":"<code>data.feature_mapping</code>","text":"<p><code>data.feature_mapping</code> maps engine/tool feature names to source fields.</p> <p>Recommended convention:</p> <ul> <li>Feature names should be stable within a tool/engine.</li> <li>If multiple sources are used, tools can adopt a qualified convention (e.g. <code>source_name.field</code>) in their own feature naming.</li> </ul>"},{"location":"Language/Schemas/Scenario/#scenariofrequency","title":"<code>scenario.frequency</code>","text":"<p>Structure:</p> <pre><code>frequency:\n  basis: per_organization_per_year | per_asset_unit_per_year\n  model: &lt;engine-defined&gt;           # optional, defaults to poisson\n  parameters: { ... }\n</code></pre> <p>Notes:</p> <ul> <li><code>basis</code> controls exposure scaling in portfolios. See \u201cExposure scaling and frequency basis\u201d in <code>wiki/Reference/CRML-Specification.md</code>.</li> <li><code>model</code> is engine-defined; if omitted it defaults to <code>poisson</code>.</li> <li><code>parameters</code> is model-specific. Common parameter names:</li> <li><code>lambda</code> (serialized as <code>lambda</code>, stored as <code>lambda_</code> internally)</li> <li><code>p</code>, <code>alpha_base</code>, <code>beta_base</code>, <code>r</code>, \u2026</li> </ul> <p>Implementation guidance (converting report counts to \\lambda):</p> <ul> <li>If a report gives N incidents across Y years for a single organization:   $\\lambda \\approx \\frac{N}{Y}$</li> <li>If a report gives N incidents across Y years across O organizations:   $\\lambda_{per\\_org} \\approx \\frac{N}{O \\cdot Y}$</li> </ul>"},{"location":"Language/Schemas/Scenario/#scenarioseverity","title":"<code>scenario.severity</code>","text":"<p>Structure:</p> <pre><code>severity:\n  model: &lt;engine-defined&gt;\n  parameters: { ... }\n  components: [ ... ]  # optional\n</code></pre> <p>Notes:</p> <ul> <li><code>model</code> is engine-defined.</li> <li>For authoring from reporting, prefer <code>median</code> and set a reasonable <code>sigma</code> until calibrated.</li> <li>For calibration, prefer <code>single_losses</code> (per-incident samples).</li> </ul>"},{"location":"Language/Schemas/Scenario/#calibration-friendly-inputs-single_losses","title":"Calibration-friendly inputs (<code>single_losses</code>)","text":"<p>Populate <code>scenario.severity.parameters.single_losses</code> with per-incident loss samples.</p> <ul> <li>Values should be positive and represent one value per event (not annual totals).</li> <li>Tools SHOULD validate that there are at least 2 values.</li> </ul>"},{"location":"Language/Schemas/Scenario/#scenariocontrols-threat-centric-relevant-controls","title":"<code>scenario.controls</code> (threat-centric relevant controls)","text":"<p><code>scenario.controls</code> is an optional, threat-centric declaration of controls that can mitigate this scenario.</p> <p>Each entry can be either:</p> <ul> <li>a canonical control id string (e.g. <code>org:iam.mfa</code>), or</li> <li>an object with scenario-scoped overrides:</li> </ul> <pre><code>- id: \"org:iam.mfa\"\n  effectiveness_against_threat: 0.8  # optional\n  notes: \"...\"                       # optional\n</code></pre> <p>Semantics (recommended):</p> <ul> <li><code>effectiveness_against_threat</code> is a threat-specific factor.</li> <li>Organization-specific posture belongs in portfolio inventory and/or assessments.</li> </ul>"},{"location":"Language/Schemas/Scenario/#validation","title":"Validation","text":"<p>Python:</p> <pre><code>from crml_lang import validate_scenario\n\nreport = validate_scenario(\"examples/scenarios/scenario-phishing.yaml\", source_kind=\"path\")\nassert report.ok\n</code></pre> <p>For field-by-field constraints, consult <code>crml_lang/src/crml_lang/schemas/crml-scenario-schema.json</code>.</p>"},{"location":"Language/Schemas/Simulation-Result/","title":"Simulation Result Schema (<code>crml_simulation_result: \"1.0\"</code>)","text":"<p>This page documents the CRML Simulation Result envelope shape and how to use it.</p> <ul> <li>JSON Schema: <code>crml_lang/src/crml_lang/schemas/crml-simulation-result-schema.json</code></li> <li>Pydantic model: <code>crml_lang/src/crml_lang/models/simulation_result.py</code> (<code>CRSimulationResult</code>)</li> </ul>"},{"location":"Language/Schemas/Simulation-Result/#what-a-simulation-result-is","title":"What a simulation result is","text":"<p>A simulation result is an engine-produced artifact that reports:</p> <ul> <li>whether execution succeeded,</li> <li>engine identity and run metadata,</li> <li>standardized results (measures + artifacts).</li> </ul> <p>It lives in <code>crml_lang</code> so that engines and UIs share a stable contract.</p> <p>Most users should not hand-author result envelopes.</p>"},{"location":"Language/Schemas/Simulation-Result/#top-level-structure","title":"Top-level structure","text":"<pre><code>crml_simulation_result: \"1.0\"\nresult: { ... }\n</code></pre>"},{"location":"Language/Schemas/Simulation-Result/#result-fields","title":"<code>result</code> fields","text":""},{"location":"Language/Schemas/Simulation-Result/#status-fields","title":"Status fields","text":"<ul> <li><code>success</code> (bool)</li> <li><code>errors</code> (list of strings)</li> <li><code>warnings</code> (list of strings)</li> </ul>"},{"location":"Language/Schemas/Simulation-Result/#provenance-fields","title":"Provenance fields","text":"<ul> <li><code>engine</code>: <code>{ name, version? }</code></li> <li><code>run</code>: optional run metadata (<code>runs</code>, <code>seed</code>, <code>runtime_ms</code>, <code>started_at</code>)</li> <li><code>inputs</code>: optional captured input metadata (model name/version/description)</li> <li><code>units</code>: optional unit metadata (currency + horizon)</li> </ul>"},{"location":"Language/Schemas/Simulation-Result/#result-payload","title":"Result payload","text":"<p><code>results</code> contains:</p> <ul> <li><code>measures</code>: list of <code>{ id, value, unit?, parameters?, label? }</code></li> <li><code>artifacts</code>: list of artifacts (currently <code>histogram</code> and <code>samples</code>)</li> </ul> <p>Artifact kinds:</p> <ul> <li><code>histogram</code>: <code>{ kind: histogram, bin_edges: [...], counts: [...] }</code></li> <li><code>samples</code>: <code>{ kind: samples, values: [...], sample_count_total?, sample_count_returned? }</code></li> </ul>"},{"location":"Language/Schemas/Simulation-Result/#minimal-skeleton-example","title":"Minimal skeleton example","text":"<pre><code>crml_simulation_result: \"1.0\"\nresult:\n  success: true\n  errors: []\n  warnings: []\n  engine:\n    name: crml_engine\n    version: \"...\"\n  run:\n    runs: 10000\n    seed: 123\n  units:\n    currency: { kind: currency, code: USD, symbol: \"$\" }\n    horizon: annual\n  results:\n    measures:\n      - id: eal\n        value: 12345.67\n    artifacts: []\n</code></pre>"},{"location":"Language/Schemas/Simulation-Result/#validation-consumption","title":"Validation / consumption","text":"<p>Consumers (web UI, reporting, BI) should validate against the schema and then treat unknown fields in <code>parameters</code>/<code>binning</code>/<code>sampling</code> as engine-defined.</p> <p>Python:</p> <pre><code>from crml_lang.models.simulation_result import CRSimulationResult\nenv = CRSimulationResult.model_validate(result_dict)\n</code></pre>"},{"location":"Project/Roadmap-Short/","title":"Roadmap (short)","text":"<p>Roadmap items are tracked outside of the documentation.</p> <ul> <li>For current capabilities, see the Language/Engine sections.</li> <li>For historical changes, see the package changelogs.</li> <li>For forward looking features, see the issues/discussions.</li> </ul>"},{"location":"Reference/CRML-Schema/","title":"CRML Schemas","text":"<p>The CRML language is validated via JSON Schema (as emitted by the <code>crml_lang</code> Pydantic models) plus additional semantic checks.</p> <ul> <li><code>crml_lang</code> provides the language schemas and the validator.</li> <li>The <code>crml</code> CLI (from <code>crml_engine</code>) delegates document validation to <code>crml_lang</code>.</li> </ul> <p>CRML is not a single schema: it is a set of document types, each with its own schema.</p>"},{"location":"Reference/CRML-Schema/#language-schemas-crml_lang","title":"Language schemas (<code>crml_lang</code>)","text":"<p>Canonical schema files live in:</p> <pre><code>crml_lang/src/crml_lang/schemas/\n</code></pre> <p>Specifically:</p> <ul> <li><code>crml-scenario-schema.json</code> (<code>crml_scenario: \"1.0\"</code>) \u2014 usage: Language/Schemas/Scenario</li> <li><code>crml-portfolio-schema.json</code> (<code>crml_portfolio: \"1.0\"</code>) \u2014 usage: Language/Schemas/Portfolio</li> <li><code>crml-control-catalog-schema.json</code> (<code>crml_control_catalog: \"1.0\"</code>) \u2014 usage: Language/Schemas/Control-Catalog</li> <li><code>crml-attack-catalog-schema.json</code> (<code>crml_attack_catalog: \"1.0\"</code>) \u2014 usage: Language/Schemas/Attack-Catalog</li> <li><code>crml-attack-control-relationships-schema.json</code> (<code>crml_attack_control_relationships: \"1.0\"</code>) \u2014 usage: Language/Schemas/Attack-Control-Relationships</li> <li><code>crml-assessment-schema.json</code> (<code>crml_assessment: \"1.0\"</code>) \u2014 usage: Language/Schemas/Assessment</li> <li><code>crml-control-relationships-schema.json</code> (<code>crml_control_relationships: \"1.0\"</code>) \u2014 usage: Language/Schemas/Control-Relationships</li> <li><code>crml-portfolio-bundle-schema.json</code> (<code>crml_portfolio_bundle: \"1.0\"</code>) \u2014 usage: Language/Schemas/Portfolio-Bundle</li> <li><code>crml-simulation-result-schema.json</code> (<code>crml_simulation_result: \"1.0\"</code>) \u2014 usage: Language/Schemas/Simulation-Result</li> </ul> <p>In addition to JSON Schema validation, <code>crml_lang</code> performs semantic validation (examples):</p> <ul> <li>Cross-references exist and types match (e.g. portfolios reference valid scenarios).</li> <li>Consistency rules (e.g. portfolios that reference <code>assessments</code> must also reference <code>control_catalogs</code>).</li> </ul>"},{"location":"Reference/CRML-Schema/#engine-owned-schemas-crml_engine","title":"Engine-owned schemas (<code>crml_engine</code>)","text":"<p>Some documents are execution-time configuration and belong to an engine rather than to the language.</p> <p>The reference engine includes an FX config schema:</p> <pre><code>crml_engine/src/crml_engine/schemas/crml-fx-config-schema.json\n</code></pre> <p>Usage documentation: Language/Schemas/FX-Config</p> <p>Engines MAY define additional runtime config documents; those are not part of the CRML language unless adopted into <code>crml_lang</code>.</p>"},{"location":"Reference/CRML-Schema/#programmatic-validation","title":"Programmatic validation","text":"<p>To validate programmatically:</p> <pre><code>from crml_lang import validate\n\nreport = validate(\"doc.yaml\", source_kind=\"path\")\nif not report.ok:\n    raise SystemExit(report.render_text(source_label=\"doc.yaml\"))\n</code></pre> <p>For exact field-by-field constraints, open the schema JSON files directly.</p>"},{"location":"Reference/CRML-Schema/#how-schemas-are-generated","title":"How schemas are generated","text":"<p>The JSON Schema files shipped in <code>crml_lang/src/crml_lang/schemas/</code> are generated from the Pydantic models in <code>crml_lang/src/crml_lang/models/</code>.</p> <p>The generator script is:</p> <pre><code>crml_lang/tools/generate_schemas.py\n</code></pre> <p>From the repo root, you can regenerate schemas with:</p> <pre><code>python crml_lang/tools/generate_schemas.py\n</code></pre> <p>Notes:</p> <ul> <li>If you change model fields/descriptions in <code>crml_lang</code>, regenerate schemas so docs and packaged schema JSON stay in sync.</li> </ul>"},{"location":"Reference/CRML-Specification/","title":"CRML Specification","text":"<p>This page is the entry point for the CRML language contracts (schemas + minimal semantics) and how they relate to execution engines.</p> <ul> <li>Language overview: Architecture-Language</li> <li>Engine overview: Architecture-Engine</li> <li>JSON Schemas: CRML-Schema</li> <li>Practical workflow: Quickstart</li> </ul> <p>CRML is designed so that:</p> <ul> <li>The language (<code>crml_lang</code>) defines document shapes and a small set of portable semantics.</li> <li>Engines (including the reference engine <code>crml_engine</code>) decide how to fit/infer/execute models and which algorithms and outputs they support.</li> </ul> <p>Normative keywords on this page are interpreted as in RFC 2119: MUST, MUST NOT, SHOULD, SHOULD NOT, MAY.</p>"},{"location":"Reference/CRML-Specification/#language-vs-engine-responsibilities","title":"Language vs engine responsibilities","text":"<p>Language-defined (portable)</p> <ul> <li>Document discriminators and top-level shapes (e.g. <code>crml_scenario: \"1.0\"</code>).</li> <li>Field meaning at the \u201ccommon denominator\u201d level (e.g. frequency basis, severity parameter intent).</li> <li>Cross-document linking rules (e.g. a portfolio references scenarios and binds them to assets).</li> <li>Minimal semantics for exposure scaling (see below).</li> </ul> <p>Engine-defined (implementation-specific)</p> <ul> <li>Which <code>scenario.frequency.model</code> and <code>scenario.severity.model</code> identifiers are supported.</li> <li>Fitting/inference workflows (e.g. MCMC/VI), diagnostics, and report formats.</li> <li>Runtime options (sample counts, seeds, performance knobs).</li> <li>Execution-time configuration documents (e.g. FX config) and engine-specific extensions.</li> </ul>"},{"location":"Reference/CRML-Specification/#current-crml-document-types","title":"Current CRML document types","text":"<p>CRML is document-oriented. Rather than a single \u201cmodel file\u201d, you typically manage multiple documents (often via CRML Studio or a similar tool).</p>"},{"location":"Reference/CRML-Specification/#scenario-document-crml_scenario-10","title":"Scenario document (<code>crml_scenario: \"1.0\"</code>)","text":"<p>A scenario describes one risk model (frequency + severity, optional controls) without asserting portfolio exposure.</p> <p>Minimal structure:</p> <pre><code>crml_scenario: \"1.0\"\nmeta:\n  name: \"example\"\n  version: \"1.0\"\nscenario:\n  frequency:\n    basis: per_organization_per_year\n    model: poisson\n    parameters:\n      lambda: 0.1\n  severity:\n    model: lognormal\n    parameters:\n      median: 22000\n      currency: USD\n      sigma: 1.0\n</code></pre> <p>Notes:</p> <ul> <li><code>scenario.frequency.basis</code> expresses the unit basis of the event rate (see \u201cExposure scaling\u201d below).</li> <li><code>scenario.severity.parameters</code> is required (may be <code>{}</code> for parameterless models).</li> </ul>"},{"location":"Reference/CRML-Specification/#portfolio-document-crml_portfolio-10","title":"Portfolio document (<code>crml_portfolio: \"1.0\"</code>)","text":"<p>A portfolio defines exposure (assets and cardinalities) and binds one or more scenarios to some or all assets.</p> <p>Minimal structure:</p> <pre><code>crml_portfolio: \"1.0\"\nmeta:\n  name: \"example-portfolio\"\nportfolio:\n  assets:\n    - name: endpoints\n      cardinality: 500\n    - name: employees\n      cardinality: 100\n  scenarios:\n    - scenario: \"scenarios/phishing.yaml\"\n      binding:\n        applies_to_assets: [employees]\n</code></pre> <p>Notes:</p> <ul> <li><code>portfolio.scenarios[].binding.applies_to_assets</code> MAY be omitted/null, in which case it is interpreted as \u201call portfolio assets\u201d.</li> <li>If <code>applies_to_assets</code> is an empty list, it binds to no assets (total exposure E=0); engines SHOULD treat this as a configuration error for per-asset frequency basis.</li> </ul>"},{"location":"Reference/CRML-Specification/#control-packs-crml_control_catalog-crml_assessment-crml_control_relationships","title":"Control packs (<code>crml_control_catalog</code>, <code>crml_assessment</code>, <code>crml_control_relationships</code>)","text":"<p>Control catalogs, assessments, and control relationships are separate documents that can be referenced from portfolios.</p> <ul> <li>If a portfolio references <code>assessments</code>, it MUST also reference the corresponding <code>control_catalogs</code> (so the assessment IDs can be interpreted).</li> </ul> <p>Control relationships packs (<code>crml_control_relationships: \"1.0\"</code>) provide portable control-to-control mappings (grouped 1\u2192N by source) with quantitative overlap metadata.</p> <ul> <li>A portfolio MAY reference <code>control_relationships</code> to enable tools/engines to resolve scenario control ids to implemented portfolio controls (especially when different frameworks or id namespaces are involved).</li> </ul>"},{"location":"Reference/CRML-Specification/#portfolio-bundles-and-simulation-results","title":"Portfolio bundles and simulation results","text":"<p>CRML also defines stable \u201cenvelope\u201d documents for interoperability:</p> <ul> <li><code>crml_portfolio_bundle: \"1.0\"</code> (a bundle of portfolio + referenced artifacts)</li> <li><code>crml_simulation_result: \"1.0\"</code> (a results document)</li> </ul>"},{"location":"Reference/CRML-Specification/#exposure-scaling-and-frequency-basis-normative","title":"Exposure scaling and frequency basis (normative)","text":"<p>This section standardizes the minimal semantics needed for consistent portfolio scaling across engines.</p>"},{"location":"Reference/CRML-Specification/#definitions","title":"Definitions","text":"<ul> <li>Each portfolio asset has a non-negative integer <code>cardinality</code> (number of exposure units).</li> <li>For a portfolio scenario reference, define the bound asset set A:</li> <li>If <code>binding.applies_to_assets</code> is omitted or null: A is all portfolio assets.</li> <li>If <code>binding.applies_to_assets</code> is provided: A is exactly that list.</li> <li>Define total bound exposure E as:</li> </ul>  E = \\sum_{a \\in A} \\mathrm{cardinality}(a)"},{"location":"Reference/CRML-Specification/#basis-semantics","title":"Basis semantics","text":"<ul> <li>If <code>scenario.frequency.basis</code> is <code>per_organization_per_year</code>:</li> <li>Engines MUST treat the frequency model as already expressing the total organization-wide annual rate.</li> <li> <p>Asset bindings MUST NOT change the expected annual event count (i.e. the effective exposure multiplier is 1).</p> </li> <li> <p>If <code>scenario.frequency.basis</code> is <code>per_asset_unit_per_year</code>:</p> </li> <li>Engines MUST scale the expected annual event count linearly with E.</li> <li>For example, for a Poisson model with per-unit rate \\lambda:</li> </ul>  \\lambda_{\\mathrm{total}} = \\lambda \\cdot E"},{"location":"Reference/CRML-Specification/#validation-guidance","title":"Validation guidance","text":"<ul> <li>If <code>per_asset_unit_per_year</code> and E=0, tools SHOULD emit a validation error or warning (no exposure bound).</li> <li>If <code>per_organization_per_year</code> and <code>applies_to_assets</code> is provided, tools SHOULD warn that the binding does not affect frequency (but may still affect control coverage or reporting).</li> </ul> <p>Notes:</p> <ul> <li>These checks are implementable at the language/tooling layer because they depend only on (a) the portfolio assets/binding and (b) the referenced scenario\u2019s <code>frequency.basis</code>.</li> <li>The reference implementation in this repository emits these as semantic warnings during portfolio validation via <code>crml_lang.validate_portfolio(...)</code>.</li> <li>Because the checks require reading the referenced scenario document to know <code>frequency.basis</code>, they are emitted when portfolio validation is configured to load scenarios (e.g. <code>portfolio.semantics.constraints.validate_scenarios: true</code>) and the scenario file can be loaded.</li> </ul> <p>Example (Python):</p> <pre><code>from crml_lang import validate_portfolio\n\nreport = validate_portfolio(\"examples/portfolios/portfolio.yaml\", source_kind=\"path\")\nfor w in report.warnings:\n  print(w.path, w.message)\n</code></pre>"},{"location":"Reference/FAQ/","title":"FAQ","text":""},{"location":"Reference/FAQ/#is-crml-a-single-model-file-format","title":"Is CRML a single \u201cmodel file\u201d format?","text":"<p>No. In this repo CRML is document-oriented (scenarios, portfolios, catalogs, assessments, bundles).</p> <p>See: CRML Specification (Overview)</p>"},{"location":"Reference/FAQ/#where-is-the-simulation-cli","title":"Where is the simulation CLI?","text":"<p>Install <code>crml-engine</code> to get the <code>crml</code> CLI.</p> <p>See: Engine CLI</p>"},{"location":"Reference/FAQ/#which-frequencyseverity-models-are-supported","title":"Which frequency/severity models are supported?","text":"<p>Model support is engine-defined.</p> <p>See: Engine capabilities: Supported models</p>"},{"location":"Reference/FAQ/#does-the-reference-engine-support-mcmc","title":"Does the reference engine support MCMC?","text":"<p>Not today. The Concepts page explains what MCMC is and how it would fit.</p> <p>See: Runtime (MCMC)</p>"},{"location":"Reference/Glossary/","title":"Glossary","text":""},{"location":"Reference/Glossary/#scenario","title":"Scenario","text":"<p>A <code>crml_scenario: \"1.0\"</code> document describing frequency + severity assumptions (and optionally referenced controls).</p> <p>See: Language/Schemas/Scenario</p>"},{"location":"Reference/Glossary/#portfolio","title":"Portfolio","text":"<p>A <code>crml_portfolio: \"1.0\"</code> document that defines exposure (assets, cardinalities) and binds scenarios.</p> <p>See: Language/Schemas/Portfolio</p>"},{"location":"Reference/Glossary/#eal","title":"EAL","text":"<p>Expected annual loss: the mean of the annual loss distribution.</p>"},{"location":"Reference/Glossary/#var","title":"VaR","text":"<p>Value at Risk at percentile p: the p-quantile of the annual loss distribution.</p>"},{"location":"Reference/Glossary/#basis","title":"Basis","text":"<p>The unit semantics of the frequency model (e.g., per organization per year vs per asset unit per year).</p> <p>See: CRML Specification (Overview)</p>"},{"location":"Reference/Troubleshooting/","title":"Troubleshooting","text":""},{"location":"Reference/Troubleshooting/#crml-command-not-found","title":"<code>crml</code> command not found","text":"<ul> <li>Ensure you installed the engine package: <code>pip install crml-engine</code></li> <li>Verify: <code>crml --help</code></li> </ul>"},{"location":"Reference/Troubleshooting/#validation-fails-but-yaml-looks-fine","title":"Validation fails but YAML looks fine","text":"<ul> <li>Run <code>crml validate &lt;file&gt;</code> to get the exact path and error.</li> <li>Confirm the top-level discriminator exists (e.g., <code>crml_scenario: \"1.0\"</code>).</li> </ul> <p>See: Validation</p>"},{"location":"Reference/Troubleshooting/#simulation-succeeds-but-results-look-wrong","title":"Simulation succeeds but results look wrong","text":"<ul> <li>Start with fewer runs to iterate (<code>--runs 1000</code>), then increase to stabilize percentiles.</li> <li>Confirm whether frequency basis is <code>per_organization_per_year</code> vs <code>per_asset_unit_per_year</code>.</li> </ul> <p>See: Runtime (Frequency)</p>"},{"location":"Reference/Troubleshooting/#multi-currency-conversion-surprises","title":"Multi-currency conversion surprises","text":"<ul> <li>Confirm you are using an FX config (<code>--fx-config ...</code>) and that your rates are relative to <code>base_currency</code>.</li> </ul> <p>See: Multi-Currency Support</p>"}]}