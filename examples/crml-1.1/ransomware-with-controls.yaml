crml: "1.1"

meta:
  name: "ransomware-with-controls"
  version: "1.0"
  description: "Ransomware risk model with layered security controls demonstrating defense-in-depth"
  author: "CRML Team"
  tags: ["ransomware", "controls", "defense-in-depth"]
  industries: ["all"]
  locale:
    regions: ["world"]
    countries: []
  company_size: ["enterprise"]

model:
  frequency:
    model: poisson
    parameters:
      lambda: 0.15  # 15% annual probability without controls
  
  controls:
    layers:
      - name: "email_security"
        description: "Email filtering and anti-phishing controls"
        controls:
          - id: "email_filtering"
            type: "preventive"
            effectiveness: 0.90  # Blocks 90% of phishing emails
            coverage: 1.0        # Covers all users
            reliability: 0.95    # 95% uptime
            cost: 50000
            currency: USD
          
          - id: "security_awareness_training"
            type: "preventive"
            effectiveness: 0.60  # Reduces user click rate by 60%
            coverage: 0.95       # 95% of users trained
            reliability: 0.90    # 90% retention/effectiveness
            cost: 25000
            currency: USD
      
      - name: "endpoint_protection"
        description: "Endpoint detection and response"
        controls:
          - id: "edr"
            type: "detective"
            effectiveness: 0.80  # Detects 80% of malware
            coverage: 0.98       # Deployed on 98% of endpoints
            reliability: 0.92    # 92% detection accuracy
            cost: 120000
            currency: USD
          
          - id: "application_whitelisting"
            type: "preventive"
            effectiveness: 0.85  # Prevents 85% of unauthorized execution
            coverage: 0.90       # 90% of critical systems
            reliability: 0.95    # 95% effectiveness
            cost: 40000
            currency: USD
      
      - name: "network_defense"
        description: "Network segmentation and monitoring"
        controls:
          - id: "network_segmentation"
            type: "preventive"
            effectiveness: 0.70  # Limits lateral movement
            coverage: 0.85       # 85% of network segmented
            reliability: 0.99    # Very reliable once implemented
            cost: 80000
            currency: USD
      
      - name: "backup_recovery"
        description: "Immutable backups and recovery capabilities"
        controls:
          - id: "immutable_backups"
            type: "recovery"
            effectiveness: 0.95  # 95% recovery success rate
            coverage: 0.98       # 98% of data backed up
            reliability: 0.99    # 99% backup reliability
            cost: 75000
            currency: USD
    
    dependencies:
      - controls: ["email_filtering", "security_awareness_training"]
        correlation: 0.4  # Both target email-based attacks
      
      - controls: ["edr", "application_whitelisting"]
        correlation: 0.3  # Some overlap in endpoint protection
  
  severity:
    model: lognormal
    parameters:
      median: "700 000"  # $700K median ransomware payment + recovery
      currency: USD
      sigma: 1.8         # High variability in ransomware costs

output:
  metrics:
    - EAL
    - VaR_95
    - VaR_99
  
  control_analysis:
    show_baseline_comparison: true
    show_control_roi: true

# Expected Results:
# ================
# Without controls: Lambda = 0.15 (15% annual probability)
# With controls:    Lambda ≈ 0.0058 (0.58% annual probability)
# Risk reduction:   ≈ 96.1%
#
# Control effectiveness breakdown:
# - Email filtering:     90% × 100% × 95% = 85.5% reduction
# - Security awareness:  60% × 95% × 90% = 51.3% reduction  
# - EDR:                 80% × 98% × 92% = 72.1% reduction
# - App whitelisting:    85% × 90% × 95% = 72.7% reduction
# - Network segmentation: 70% × 85% × 99% = 58.9% reduction
# - Immutable backups:   95% × 98% × 99% = 92.2% reduction
#
# Combined (defense in depth):
# P(breach) = 0.15 × (1-0.855) × (1-0.513) × (1-0.721) × (1-0.727) × (1-0.589) × (1-0.922)
#           ≈ 0.0058 (0.58%)
#
# Total control cost: $390,000/year
# Risk reduction: ~$105K in expected losses (if EAL baseline ≈ $105K)
# ROI depends on baseline EAL
